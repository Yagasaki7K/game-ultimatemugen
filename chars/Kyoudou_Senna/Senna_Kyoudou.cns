;変数使用表
;　1 = 
;　2 = 生存判別用
;　3 = GameTime（BBB攻撃値半減＆椿.乱）
;　4 = スロー処理
;　5 = 強弱ボタン判定
;　6 = 通常攻撃ボイス、乱数指定
;　7 = 透過処理
;　8 = カウンター
;　9 = 緋空閃
; 10 = プレイヤーの向き設定
; 11 = 暗転用変数
; 12 = KOサウンド
; 13 = 勝利判定
; 14 = 攻撃力
; 15 = ハイジャンプ
; 16 = 
; 17 = ダメージ補正に使用
; 18 = 攻撃値の保存
; 19 = Pゲージ表示位置
; 20 = 強月華バウンド判定
; 21 = 事前コマンド入力用
; 22 = 透明化
; 23 = AI用相手の幅記憶
; 24 = 空中ジャンプ＆振り向き攻撃制御
; 25 = ヒット数
; 26 = コンボ時間
; 27 = movehit改
; 28 = 
; 29 = ダメージ計算（緋空閃）
; 30 = ダメージ量算出

; 48 = AIのオリジナル技使用可否
; 49 = 勝利演出
; 50 = ダウン追い討ち設定
; 51 = 攻撃値<=>Life持ち越し
; 52 = AIガードレベル
; 53 = BBB攻撃値
; 54 = LOSE判定
; 55 = エンハンス使用回数
; 56 = Pゲージ使用量
; 57 = Pゲージ有無
; 58 = VarRandom
; 59 = AI判定

; f(0) = 補正値
; f(1) = 逆根性値補正
; f(2) = ヒット数補正
; f(3) = 基底ダメージ補正
; f(4) = ノックバック補正
; f(5) = 
; f(6) = 

; channel = 4	
; channel = 5	イントロ



[Data]
  ;体力ゲージの初期値
life = 1000
  ;攻撃力（これ以上に設定すると強くなる）
power = 5000
attack = 100
  ;防御力（これ以上に設定すると強くなる）
defence = 100
  ;コンボをくらっている時にあがる防御力
fall.defence_up = 50
  ;倒れてから起上がるまでのフレーム数
liedown.time = 20
  ;空中でどれだけコンボが繋がるか（高くすると無限コンボになるので注意）
airjuggle = 15
  ;hitdefで設定していない時の基本ヒットスパークナンバー
sparkno = 2
  ;設定してない時のガードナンバー
guard.sparkno = 40
  ;KOした時に声にエコーをかけるか（１でＯＮ）
KO.echo = 0
 volume = 100
  IntPersistIndex = 48,59
FloatPersistIndex = 40

[Size]
xscale = 1           ;水平方向の縮尺（通常１）
yscale = 1           ;垂直方向の縮尺（通常１）
ground.back = 16     ;キャラの幅(後方,地上)
ground.front = 16    ;キャラの幅(前方,地上)
air.back = 12        ;キャラの幅(後方,空中)
air.front = 12       ;キャラの幅(前方,空中)
height = 90          ;キャラの高さ
attack.dist = 320    ;攻撃をした時相手がガード体制に入る最低距離
proj.attack.dist = 320;攻撃をした時相手がガード体制に入る最低距離（飛び道具）
proj.doscale = 0     ;上で設定した縮尺を飛び道具にも適用するか（１でＯＮ）   
head.pos = -6, -80   ;頭の大体の座標
mid.pos = -5, -54    ;体の中心の大体の座標
shadowoffset = 0     ;影の垂直方向のオフセット
draw.offset = 0,0    ;使用しない

[Velocity]
walk.fwd  = 2.1           ;前進の速度
walk.back = -1.9          ;後退の速度
run.fwd  = 7.9, 0         ;前ダッシュの速度（ホップする時はyを-にする）
run.back = -6.7,-4.0      ;後ダッシュの速度（ホップする時はyを-にする）
jump.neu = 0,-9.0        ;垂直ジャンプの速度
jump.back = -2.1,1        ;後ジャンプの速度
jump.fwd = 2.4,1          ;前ジャンプの速度
runjump.back = -2.1,1     ;後ダッシュしながらのジャンプ速度(オプション)
runjump.fwd = 2.4,1       ;前ダッシュしながらのジャンプ速度(オプション)
airjump.neu = 0,-9.0     ;２段ジャンプ以降の垂直ジャンプの速度(オプション)
airjump.back = -2.1       ;２段ジャンプ以降の後ジャンプの速度(オプション)
airjump.fwd = 2.5         ;２段ジャンプ以降の前ジャンプの速度

[Movement]
airjump.num = 1       ;空中でジャンプする回数
airjump.height = 35   ;空中でジャンプする最低限の高さ
yaccel = .38          ;重力
stand.friction = .8 ;85  ;立ち状態の摩擦係数
crouch.friction = .8 ;82;屈み状態の摩擦係数

;---------------------------------------------------------------------
; バックステップ着地
[Statedef 106]
type    = S
physics = N
ctrl = 0
anim = 106
velset = 0,0

[State 00]
type = PlaySnd
trigger1 = time = 0
value = 40, 0

[State 00]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[State 01]
type = PosSet
trigger1 = Time = 0
y = 0

[State explod];エフェクト
type = Explod
trigger1 = time = 0
anim = 6001
id = 3000
sprpriority = 2
postype = p1
pos = 0,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

[State 03]
type = ChangeState
triggerall = !var(59)
trigger1 = command = "holdback"
trigger1 = InGuardDist
value = 120

[State 03]
type = CtrlSet
trigger1 = AnimElemTime(3) = 0
value = 1

[State 03]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; 空中ダッシュ
[Statedef 110]
type    = A
physics = N
anim = 110
sprpriority = 1
velset = 0,0
ctrl = 0

[State 00]
type = PlaySnd
trigger1 = time = 0
value = 110, 0

[State 01]
type = VelSet
trigger1 = time = 0
x = 5.7

[State 02] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 03] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

;---------------------[ヘルパー]
[state a];エフェクト
type = Helper
trigger1 = time = 0
id = 6000
name = "a_dash"
sprpriority = -2
pos = 40,-65
postype = p1
stateno = 6003
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[State 04]
type = ChangeState
trigger1 = time > 21 ;16
value = 111

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 6

;---------------------------------------------------------------------------
; 空中バックダッシュ
[Statedef 115]
type    = A
physics = N
anim = 115
sprpriority = 1
velset = 0,0
ctrl = 0

[State 00]
type = PlaySnd
trigger1 = time = 0
value = 110, 0

[State 01]
type = VelSet
trigger1 = time = 0
x = -5.5

[State 02] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 03] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

;---------------------[ヘルパー]
[state a];エフェクト
type = Helper
trigger1 = time = 0
id = 6000
name = "a_dash"
sprpriority = -2
pos = -40,-65
postype = p1
stateno = 6003
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[State 04]
type = ChangeState
trigger1 = time > 21 ;16
value = 111

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 6

;---------------------------------------------------------------------------
; 空中ダッシュ終了
[Statedef 111]
type    = A
physics = A
anim = 111
sprpriority = 1
ctrl = 0

[State 03] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 120]
type = ChangeState
triggerall = !var(59)
trigger1 = command = "holdback"
trigger1 = InGuardDist
value = 120

;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)空中ダッシュエフェクト用ヘルパー
[Statedef 6003]
type = A
ctrl = 0
anim = 6003
velset = -9,0
movetype = I
physics = N
sprpriority = 2

[state a]
type = velmul
trigger1 = Time = 0
trigger1 = root,vel X < 0
;trigger1 = root,stateno = 115
x = -1

[state a]
type = turn
trigger1 = time = 0
trigger1 = root,vel X < 0
;trigger1 = root,stateno = 115

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[ヘルパー]
[state a];エフェクト
type = Helper
trigger1 = time = 0
id = 1
name = "a_dash"
sprpriority = -2
pos = -10,-21
postype = p1
stateno = 6005
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state a];エフェクト
type = Helper
trigger1 = time = 0
id = 2
name = "a_dash"
sprpriority = -2
pos = -10,-0
postype = p1
stateno = 6005
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state a];エフェクト
type = Helper
trigger1 = time = 0
id = 3
name = "a_dash"
sprpriority = -2
pos = -10,14
postype = p1
stateno = 6005
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 198,256

[state a]
type = AssertSpecial
trigger1 = AnimElemTime(5) >= 2
flag = invisible

[State 50, 4];残像
type = AfterImage
trigger1 = time = 0
time = 12
trans = addalpha
timegap = 1
framegap = 1
length = 4
palbright = 0,0,0
palcontrast = 50,50,150
palpostbright = 0,0,0
paladd = 0,0,0
palmul = .65,.65,.65

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0


;----------------------------------------------------------------------------
;(HELPER)空中ダッシュエフェクト用ヘルパー2
[Statedef 6005]
type = A
ctrl = 0
anim = 6005
velset = 0,0
movetype = I
physics = N
sprpriority = 2

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state a]
type = VarSet
trigger1 = time = 0
v = 1
value = 0

[state a]
type = varadd
trigger1 = 1
v = 1
value = 1

;---------------------[速度]
[state a]
type = velset
trigger1 = time = 0
x = -2.5-(Random%40)/10

[state a]
type = velset
trigger1 = time = 0
trigger1 = ishelper(1)
y = -1-(Random%25)/10

[state a]
type = velset
trigger1 = time = 0
trigger1 = ishelper(2)
y = -0.5+(Random%10)/10

[state a]
type = velset
trigger1 = time = 0
trigger1 = ishelper(3)
y = 1+(Random%25)/10

;---------------------[透過、拡縮]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 96,256

[state a]
type = angledraw
trigger1 = 1
scale = 1.0-var(1)*0.04,1.0-var(1)*0.04

[State 50, 4];残像
type = AfterImage
trigger1 = time = 0
time = 40
trans = addalpha
timegap = 1
framegap = 1
length = 5 ;8
palbright = 50,50,50
palcontrast = 60,60,100
palpostbright = 0,0,0
paladd = -10,-10,-10
palmul = .8,.8,.8

;---------------------[]
[state a]
type = destroyself
trigger1 = time = 25

;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]




;---------------------------------------------------------------------------
; タイムオーバーで負けた時
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 00];不覚でした…
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 170,0
volume = 150

[State 00]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; 勝った動作
[Statedef 180]
type = S

[State 00]
type = null;VarRandom
trigger1 = Time = 0
v = 2
range = 0,1

[State 01]
type = null;ChangeState
trigger1 = MatchOver = 1
value = 182

[State 01]
type = ChangeState
trigger1 = 1
value = 181


;---------------------------------------------------------------------------
; 勝った動作1[通常勝利]
[Statedef 181]
type = A
ctrl = 0
anim = 181
velset = 0,0
physics = N

[State 00];はむかわないで
type = PlaySnd
triggerall = animelemtime(2) = 0
trigger1 = WinPerfect
trigger1 = var(29) = LifeMax
volume = 150
value = 181, 2
channel = 1

[State 00];これからが本番
type = PlaySnd
triggerall = animelemtime(2) = 0
trigger1 = RoundNo = 1
value = 181, 3
volume = 150
channel = 1
lowpriority = 1

[State 00];本気じゃないと
type = PlaySnd
trigger1 = animelemtime(2) = 0
trigger1 = var(29) >= 500
value = 181, 0
volume = 150
channel = 1
lowpriority = 2

[State 00];乱暴にしないで
type = PlaySnd
trigger1 = animelemtime(2) = 0
trigger1 = var(29) < 500
value = 181, 1
volume = 150
channel = 1
lowpriority = 3

[State 1];カメラ固定
type = screenbound
trigger1 = 1
value = 1
movecamera = 1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 181, 4]
type = AssertSpecial
trigger1 = time = [0,190]
flag = roundnotover

[State 181, 4]
type = AssertSpecial
trigger1 = var(49)
trigger1 = MatchOver
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = time = [0,220+820*(var(49)=2)] ;840
flag = roundnotover

[state 181];勝利演出
type = Helper
triggerall = var(49)
triggerall = numhelper(8500) = 0
trigger1 = (TeamMode = Single) || (TeamMode = Turns)
trigger1 = MatchOver
trigger1 = time = 200*(var(49)=2) ;220
id = 8500
name = "win"
sprpriority = 10
pos = 0,0
postype = back
stateno = 8500
helpertype = normal
pausemovetime = 0
bindtime = -1
keyctrl = 0 
ownpal = 1

;---------------------------------------------------------------------------
; 通常登場
[Statedef 190]
type = S
ctrl = 0
anim = 190
velset = 0,0

[State a];You're already dead !!
type = PlaySnd
trigger1 = animelemtime(3) = 0
trigger1 = p2name != "Rouga_Zanma"
trigger1 = p2name != "Rouga"
value = 190,0
volume = 150
channel = 5
lowpriority = 1

[State a];対狼牙
type = PlaySnd
triggerall = animelemtime(3) = 0
trigger1 = p2name = "Rouga_Zanma"
trigger2 = p2name = "Rouga"
trigger3 = TeamMode = Simul
trigger3 = partner,name = "Rouga_Zanma"
trigger4 = TeamMode = Simul
trigger4 = partner,name = "Rouga"
value = 190,1
volume = 150
channel = 5

[State a] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[State a]
type = PowerSet
trigger1 = Time = 0
trigger1 = RoundsExisted = 0
value = 1000

[State a]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; 挑発の動作
[Statedef 199]
type = S
ctrl = 0
anim = 199
velset = 0,0
movetype = I
physics = S
sprpriority = 1


[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;============================================================================
; ハイジャンプ
[Statedef 850]
Type    = U
Physics = U
ctrl = 0
vel = 0,0

[State -1] 
Type = VarSet
Trigger1 = Time = 0
V = 15
Value = 1

[State -1]
Type = ChangeState
trigger1 = Time = 0
Value = ifelse(var(59)=0, 40, 39)

;============================================================================
; 緋空閃
[Statedef 860]
type = C
physics = C
ctrl = 0
anim = ifelse(var(59)=0,11,10)

[State 860]
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < 0

[State 860]
type = VarSet
trigger1 = Time = 0
trigger1 = prevstateno != [150,152]
var(9) = 1

[State 860]
type = VarSet
trigger1 = Time = 0
trigger1 = prevstateno = [150,152]
var(9) = 2

[State 860]
type = VarSet
trigger1 = prevstateno != [150,152]
trigger1 = Time >= 30
trigger2 = prevstateno = [150,152]
trigger2 = Time >= 60
var(9) = 0

[State 860]
type = ChangeAnim
trigger1 = var(59)
trigger1 = AnimTime = 0
value = 11

; B緋空閃
[State 860, B]
type = PlaySnd
triggerall = prevstateno = [150,152]
trigger1 = Time = 0
value = 300, 3

[State 860, B]
type = PowerAdd
triggerall = prevstateno = [150,152]
trigger1 = Time = 0
value = -1000

[state 860, B];B発動
type = Helper
triggerall = prevstateno = [150,152]
trigger1 = Time = 1
id = 6010
name = "efe1"
pos = -4,-52
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 16
keyctrl = 0 
ownpal = 1

[State 860]
type = ChangeState
trigger1 = prevstateno != [150,152]
trigger1 = Time >= 30
trigger2 = prevstateno = [150,152]
trigger2 = Time >= 60
value = 12
ctrl = 1

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
;---------------------------------------------------------------------------
; 立ち弱攻撃
[Statedef 200]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 200

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

;---------------------[速度]
[state a]
type = VelSet
trigger1 = time = 0
trigger1 = prevstateno = 20
x = 0

[state a, ground.cornerpush]
type = VelSet
trigger1 = var(27) = 6 ;相手とのhitpause解除時間差
trigger1 = (p2statetype = S) || (p2statetype = C) 
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -6.4*fvar(4)

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 300, 0

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(2) = 0
trigger1 = Random < 500
value = 200,0+(Random%3)
volume = 150

;---------------------[攻撃]
[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = S, NA                     ;立ち状態で、通常の攻撃(ｓは立ち、ｎは通常、aは攻撃を表す)
damage = 8,0                   ;ダメージ量（左が当たった時、右はガードした時）
getpower = 14*(4+var(58)%4-(Random%5=0)),7*(4+var(58)%4-(Random%5=0))
givepower = 14*(6-var(58)%4-(Random%5=0)),7*(6-var(58)%4-(Random%5=0))
animtype = light                 ;当てた時の相手のポーズ（light/midium/hard/back）から選択
guardflag = MA                    ;ガードできる状態（ｍaは全ての状態でガード可能）
hitflag = MAF                    ;当てる事のできる条件
priority = 3, Hit
pausetime = ifelse((p2statetype=A),9,7),ifelse((p2statetype=A),9,12)
guard.pausetime = 7,7
sparkno = s-1                      ;ヒットエフェクトのスプライトステート（無ければ0）
sparkxy = 0, 0               ;ヒットエフェクトを表示する場所（相手の座標で）
hitsound = s400, 0                 ;ヒットした時の音（ｓ*,*にすると自分の音を使う）
guard.sparkno = s-1
guardsound = s120, 0                ;ガードした時の音（同上）
ground.type = high               ;相手のくらった場所（High：頭、体, Low：足, Trip：足払い）
ground.slidetime = 10             ;相手が後にすべる時間
guard.slidetime = 10
ground.hittime  = 10             ;コンボが繋がる時間（高くしすぎない事）
yaccel = 0.38
ground.velocity = -6*fvar(4)             ;地上で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
guard.velocity = -6
airguard.velocity = -3,-1.23     ;空中で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
air.type = high                 ;空中で相手がくらった場所（上と同じ）
air.velocity = -0.5*fvar(4),-4.5           ;空中で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
air.hittime = 10                 ;空中でコンボが繋がる時間
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -6.4*fvar(4)
guard.cornerpush.veloff = -8
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 200
nochainID = 9999
envshake.time = 2
envshake.freq = 100
envshake.ampl = 1

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7000
name = "hit"
pos = floor(p2dist x/2 +20) , floor(p2dist y/2 -63)
postype = p1
stateno = 7000
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[]
[state a]
type = ChangeState
triggerall = !var(59)
trigger1 = movecontact
trigger1 = command = "holdup"
value = 40

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;立ち中攻撃
[Statedef 210]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 210

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

;---------------------[速度]
[state a]
type = VelSet
trigger1 = time = 0
trigger1 = prevstateno = 20
x = 0

[state a, ground.cornerpush]
type = VelSet
trigger1 = var(27) = 8
trigger1 = (p2statetype = S) || (p2statetype = C) 
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -6.4*fvar(4)

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 300, 1

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
trigger1 = Random < 500
value = 210,0+(Random%3)
volume = 150

[State 200, 1];鞘
type = PlaySnd
trigger1 = animelemtime(7) = 0
value = 300, 6

;---------------------[攻撃]
[State 210, 2]
type = HitDef
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
trigger2 = !movecontact && !movereversed
attr = S, NA
animtype  = medium
damage    = 12,0
priority = 5, Hit
getpower = 20*(4+var(58)%4-(Random%5=0)),10*(4+var(58)%4-(Random%5=0))
givepower = 20*(6-var(58)%4-(Random%5=0)),10*(6-var(58)%4-(Random%5=0))
guardflag = M
pausetime = ifelse((p2statetype=A),9,7),ifelse((p2statetype=A),9,14)
pausetime = 7,7
sparkno = s-1
sparkxy = 40,-55
hitsound   = s400,1
guardsound = s120,0
guard.sparkno = s-1
ground.type = low
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
yaccel = 0.38
ground.velocity = -5*fvar(4)
guard.velocity = -5
air.velocity = -0.5*fvar(4),-4.5
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -6.4*fvar(4)
guard.cornerpush.veloff = -10
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 200
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 9999
persistent = 0
ignorehitpause = 1
keyctrl = 0
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[]
[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;立ち強攻撃
[Statedef 220]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 220

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

;---------------------[速度]
[state a]
type = VelSet
trigger1 = time = 0
trigger1 = prevstateno = 20
x = 0

[state a]
type = VelSet
trigger1 = animelemtime(4) = 0
x = 3.6

[state a, ground.cornerpush]
type = VelSet
trigger1 = var(27) = 8
trigger1 = (p2statetype = S) || (p2statetype = C) 
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -7.2*fvar(4)

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 300, 2

[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 300, 3

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemtime(5) = 0
trigger1 = Random < 500
value = 220,0+(Random%3)
volume = 150

[State 200, 1];鞘
type = PlaySnd
trigger1 = animelemtime(11) = 0
value = 300, 6

;---------------------[攻撃]
[State 220, 2]
type = HitDef
trigger1 = AnimElem = 5
trigger2 = AnimElem = 6
trigger2 = !movecontact && !movereversed
attr = S, NA
animtype  = hard
damage    = 24,0
priority = 5, Hit
getpower = 28*(4+var(58)%4-(Random%5=0)),14*(4+var(58)%4-(Random%5=0))
givepower = 28*(6-var(58)%4-(Random%5=0)),14*(6-var(58)%4-(Random%5=0))
guardflag = MA
pausetime = ifelse((p2statetype=A),11,9),ifelse((p2statetype=A),11,14)
pausetime = 9,9
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guardsound = s120,0
guard.sparkno = s-1
ground.type = high
ground.slidetime = 16
guard.slidetime = 16
ground.hittime  = 16
yaccel = 0.38
ground.velocity = -6*fvar(4)
guard.velocity = -6
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -4,-2
air.fall = 1
fall.recover = 1
fall.recovertime = 28 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -7.2*fvar(4)
guard.cornerpush.veloff = -20
airguard.cornerpush.veloff = -20
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 200
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 4

;---------------------[]
[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;---------------------------------------------------------------------------
; 踵蹴り・移動
[Statedef 250]
type    = S
movetype= A
physics = N
juggle  = 0
poweradd= 0
velset = 0,0
ctrl = 0
anim = 250
sprpriority = 1

[state a]
type = ChangeAnim
trigger1 = var(9)
trigger1 = prevstateno = 860
trigger1 = Time = 0
value = 250
elem = 4

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

;---------------------[効果音]
[State 00];voice
type = PlaySnd
trigger1 = AnimElemTime(5) = 0
value = 200,2
volume = 150

[state a];
type = PlaySnd
trigger1 = AnimElemTime(5) = 0
value = 300,4

;---------------------[移動]
[state a]
type = StateTypeSet
trigger1 = AnimElemTime(5) = 0
value = A

[state a]
type = VelSet
trigger1 = AnimElemTime(5) = 0
x = 3
y = -8.25*0.6

[state a]
type = VelAdd
trigger1 = AnimElemTime(5) >= 0
y = 0.6

[state explod];砂塵エフェクト
type = Explod
trigger1 = AnimElemTime(5) = 0
anim = 6006
id = 3000
sprpriority = 2
postype = p1
pos = -26,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

[state explod];砂塵エフェクト
type = Explod
trigger1 = AnimElemTime(5) = 0
anim = 6006
id = 3000
sprpriority = 2
postype = p1
facing = -1
pos = -11,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 7

;---------------------[]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= -3
value = 251

;---------------------------------------------------------------------------
; 踵蹴り・攻撃
[Statedef 251]
type    = S
movetype= A
physics = N
juggle  = 0
velset = 0,0
ctrl = 0
anim = 251
poweradd = 0
hitcountpersist = 1

[State 860, P Gauge]
type = VarAdd
triggerall = var(9)
trigger1 = var(57) = 1
trigger1 = movehit = 1
var(56) = ifelse(var(9)=1, 0, -30)

[State 860]
type = VarSet
trigger1 = AnimTime = 0
var(9) = 0

[state a]
type = PosSet
trigger1 = time = 0
y = 0

[state a]
type = VelSet
trigger1 = time = 0
x = 0.5

[state a]
type = VelSet
trigger1 = AnimElemTime(4) = 0
x = -1.5

[state a]
type = VelSet
trigger1 = AnimElemTime(3) = 3
trigger2 = AnimElemTime(6) = 0
x = 0

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = time = 0
value = 300,5

;---------------------[攻撃]
[State 251, 2]
type = HitDef
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
trigger2 = !movecontact && !movereversed
attr = S, NA
animtype  = hard
damage    = 34,0
priority = 5, Hit
getpower = 28*(4+var(58)%4-(Random%5=0)),14*(4+var(58)%4-(Random%5=0))
givepower = 28*(6-var(58)%4-(Random%5=0)),14*(6-var(58)%4-(Random%5=0))
hitflag = MAF
guardflag = M
pausetime = ifelse((p2statetype=A),9,7),ifelse((p2statetype=A),9,12)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,4
guardsound = s120,0
guard.sparkno = s-1
ground.type = low
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
yaccel = 0.38
ground.velocity = -7*fvar(4),0
guard.velocity = -5
air.velocity = -0.5*fvar(4),-6
air.fall = 1
fall.recover = 1
fall.recovertime = 34 ;25
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = -7*fvar(4)
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 200
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7000
name = "hit"
pos = floor(p2dist x/2 +30) , floor(p2dist y/2 -55)
postype = p1
stateno = 7000
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[]
[state a]
type = ChangeState
triggerall = !var(59)
trigger1 = movecontact
trigger1 = command = "holdup"
value = 40

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;屈み・弱攻撃
[Statedef 400]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 400
sprpriority = 1

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[State 860, P Gauge]
type = VarAdd
triggerall = var(9)
trigger1 = var(57) = 1
trigger1 = movehit = 1
var(56) = ifelse(var(9)=1, 0, -30)

[State 860]
type = VarSet
trigger1 = AnimTime = 0
var(9) = 0

;---------------------[速度]
[state a, ground.cornerpush]
type = VelSet
trigger1 = var(27) = 8
trigger1 = (p2statetype = S) || (p2statetype = C) 
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -6.4*fvar(4)

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 300, 0

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(2) = 0
trigger1 = Random < 500
value = 200,0+(Random%3)
volume = 150

;---------------------[攻撃]
[State 400, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 2
attr = C, NA
damage    = 8,0
priority = 3, Hit
animtype  = Light
hitflag = MAFD
guardflag = LA
getpower = 14*(4+var(58)%4-(Random%5=0)),7*(4+var(58)%4-(Random%5=0))
givepower = 14*(6-var(58)%4-(Random%5=0)),7*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,13)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,0
guard.sparkno = s-1
guardsound = s120,0
ground.type = low
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
yaccel = 0.38
ground.velocity = -4*fvar(4)
guard.velocity = -6
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -3,-1.23
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -6.4*fvar(4)
down.cornerpush.veloff = -6.4*fvar(4)
guard.cornerpush.veloff = -8
airguard.cornerpush.veloff = -4.8
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 400
nochainID = 9999
envshake.time = 2
envshake.freq = 100
envshake.ampl = 1

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7000
name = "hit"
pos = floor(p2dist x/2 +20) , floor(p2dist y/2 -13)
postype = p1
stateno = 7000
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-30
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[]
[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;屈み・中攻撃
[Statedef 410]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 410
sprpriority = 1

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[State 860, P Gauge]
type = VarAdd
triggerall = var(9)
trigger1 = var(57) = 1
trigger1 = movehit = 1
var(56) = ifelse(var(9)=1, 0, -30)

[State 860]
type = VarSet
trigger1 = AnimTime = 0
var(9) = 0

;---------------------[速度]
[state a]
type = VelSet
trigger1 = AnimElemTime(3) = 0
x = 4

[state a, ground.cornerpush]
type = VelSet
trigger1 = var(27) = 8
trigger1 = (p2statetype = S) || (p2statetype = C) 
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -4*fvar(4)

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 300, 4

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
trigger1 = Random < 500
value = 210,0+(Random%3)
volume = 150

;---------------------[攻撃]
[State 410, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
trigger2 = !movecontact && !movereversed
attr = C, NA
damage    = 12,0
priority = 5, Hit
animtype  = medium
hitflag = MAFD
guardflag = MA
getpower = 20*(4+var(58)%4-(Random%5=0)),10*(4+var(58)%4-(Random%5=0))
givepower = 20*(6-var(58)%4-(Random%5=0)),10*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,16)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,3
guard.sparkno = s-1
guardsound = s120,0
ground.type = low
ground.slidetime = 19
guard.slidetime = 12
ground.hittime  = 19
yaccel = 0.38
ground.velocity = -6*fvar(4)
guard.velocity = -6
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -3,-1.23
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -4*fvar(4)
down.cornerpush.veloff = -4*fvar(4)
guard.cornerpush.veloff = -8
airguard.cornerpush.veloff = -12
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 200
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7000
name = "hit"
pos = floor(p2dist x/2 +30) , floor(p2dist y/2 -36)
postype = p1
stateno = 7000
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
trigger1 = prevstateno = 1101
v = 56
value = 4

;---------------------[]
[state a]
type = ChangeState
triggerall = !var(59)
trigger1 = movecontact
trigger1 = command = "holdup"
value = 40

[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;屈み・強攻撃
[Statedef 420]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 420
sprpriority = 1

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[State 860, P Gauge]
type = VarAdd
triggerall = var(9)
trigger1 = var(57) = 1
trigger1 = movehit = 1
var(56) = ifelse(var(9)=1, 0, -30)

[State 860]
type = VarSet
trigger1 = AnimTime = 0
var(9) = 0

;---------------------[速度]
[state a, ground.cornerpush]
type = VelSet
trigger1 = var(27) = 10
trigger1 = !enemynear(var(2)),GetHitVar(fall.recover)
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -2.4*fvar(4)

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 300, 2

[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 300, 3

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
trigger1 = Random < 500
value = 220,0+(Random%3)
volume = 150

[State 200, 1];鞘1
type = PlaySnd
trigger1 = animelemtime(6) = 0
value = 2200, 1

[State 200, 1];鞘2
type = PlaySnd
trigger1 = animelemtime(10) = 0
value = 300, 6

;---------------------[攻撃]
[State 420, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
trigger2 = !movecontact && !movereversed
attr = C, NA
damage    = 18,0
priority = 8, Hit
animtype  = hard
hitflag = MAFD
guardflag = LA
pausetime = ifelse((p2statetype=A)||(p2statetype=L),11,9),ifelse((p2statetype=A)||(p2statetype=L),11,16)
guard.pausetime = 9,9
getpower = 28*(4+var(58)%4-(Random%5=0)),14*(4+var(58)%4-(Random%5=0))
givepower = 28*(6-var(58)%4-(Random%5=0)),14*(6-var(58)%4-(Random%5=0))
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,0
ground.type = low
ground.slidetime = 11
guard.slidetime = 11
ground.hittime  = 11
yaccel = 0.38
ground.velocity = -0.3*fvar(4),-4.5
guard.velocity = -8
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -4,-2
fall = 1
fall.recover = ifelse((p2statetype=A)||(p2statetype=L),1,0)
fall.recovertime = 28 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -6.4*fvar(4)
down.cornerpush.veloff = -6.4*fvar(4)
guard.cornerpush.veloff = -10
airguard.cornerpush.veloff = -18
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 410
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-40
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = VarAdd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 8-4*(prevstateno=1101)

;---------------------[]
[State 410, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;空中弱攻撃
[Statedef 600]
type    = A
movetype= A
physics = A
juggle  = 0
poweradd= 0
ctrl = 0
anim = 600
sprpriority = 1
hitcountpersist = 1

[state a]
type = ctrlset
trigger1 = animelemtime(7) = 0
value = 1

;---------------------[振り向き攻撃]
[State 600]
type = VelMul
trigger1 = time = 0
trigger1 = prevstateno = 45
trigger1 = var(24) = 2
x = ifelse(frontedgebodydist=0,0,-1)

[State 600]
type = Turn
trigger1 = time = 0
trigger1 = prevstateno = 45
trigger1 = var(24) = 2

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 300, 0

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
trigger1 = Random < 500
value = 200,0+(Random%3)
volume = 150

;---------------------[攻撃]
[State 600, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 3
attr = A, NA
damage    = 7,0
priority = 5, Hit
hitflag = MAFD
guardflag = HA
getpower = 14*(4+var(58)%4-(Random%5=0)),7*(4+var(58)%4-(Random%5=0))
givepower = 14*(6-var(58)%4-(Random%5=0)),7*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A),9,7),ifelse((p2statetype=A),9,14)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,0
guard.sparkno = s-1
guardsound = s120,0
animtype = light
ground.type = high
ground.slidetime = 10
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -4*fvar(4)
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -2,-2
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
ground.cornerpush.veloff = -4*fvar(4)
air.cornerpush.veloff = -4*fvar(4)
guard.cornerpush.veloff = -4
airguard.cornerpush.veloff = -4
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 600
nochainID = 9999
envshake.time = 2
envshake.freq = 100
envshake.ampl = 1

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7000
name = "hit"
pos = floor(p2dist x/2 +20) , floor(p2dist y/2 -43)
postype = p1
stateno = 7000
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1


;---------------------------------------------------------------------------
;空中中攻撃
[Statedef 610]
type    = A
movetype= A
physics = A
juggle  = 0
poweradd= 0
ctrl = 0
anim = 610
sprpriority = 1
hitcountpersist = 1

[state a]
type = ctrlset
trigger1 = animelemtime(8) = 0
value = 1

;---------------------[振り向き攻撃]
[State 610]
type = VelMul
trigger1 = time = 0
trigger1 = prevstateno = 45
trigger1 = var(24) = 3
x = ifelse(frontedgebodydist=0,0,-1)

[State 610]
type = Turn
trigger1 = time = 0
trigger1 = prevstateno = 45
trigger1 = var(24) = 3

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 300, 2

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(4) = 0
trigger1 = Random < 500
value = 210,0+(Random%3)
volume = 150

[State 200, 1];鞘
type = PlaySnd
trigger1 = animelemtime(7) = 0
value = 300, 6

;---------------------[攻撃]
[State 610, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 4
trigger2 = AnimElem = 5
trigger2 = !movecontact && !movereversed
attr = A, NA
damage    = 10,0
priority = 5, Hit
hitflag = MAFD
guardflag = HA
getpower = 20*(4+var(58)%4-(Random%5=0)),10*(4+var(58)%4-(Random%5=0))
givepower = 20*(6-var(58)%4-(Random%5=0)),10*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A),9,7),ifelse((p2statetype=A),9,14)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,1
guard.sparkno = s-1
guardsound = s120,0
animtype = midium
ground.type = high
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
ground.velocity = -4*fvar(4)
guard.velocity = -5
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -3,-2
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
ground.cornerpush.veloff = -7*fvar(4)
air.cornerpush.veloff = -7*fvar(4)
guard.cornerpush.veloff = -10
airguard.cornerpush.veloff = -10
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 610
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------------------------------------------------------------
;空中強攻撃
[Statedef 620]
type    = A
movetype= A
physics = A
juggle  = 0
poweradd= 0
ctrl = 0
anim = 620
sprpriority = 1
hitcountpersist = 1

[state a]
type = ctrlset
trigger1 = animelemtime(10) = 0
value = 1

;---------------------[振り向き攻撃]
[State 620]
type = VelMul
trigger1 = time = 0
trigger1 = prevstateno = 45
trigger1 = var(24) = 4
x = ifelse(frontedgebodydist=0,0,-1)

[State 620]
type = Turn
trigger1 = time = 0
trigger1 = prevstateno = 45
trigger1 = var(24) = 4

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 300, 2

[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 300, 3

[State 200, 5];攻撃ボイス
type = PlaySnd
trigger1 = AnimElemTime(5) = 0
trigger1 = Random < 500
value = 220,0+(Random%3)
volume = 150

[State 200, 1];鞘1
type = PlaySnd
trigger1 = animelemtime(8) = 0
value = 2200, 1

[State 200, 1];鞘2
type = PlaySnd
trigger1 = animelemtime(9) = 0
value = 300, 6

;---------------------[攻撃]
[State 620, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 4
trigger2 = AnimElem = 5
trigger2 = !movecontact && !movereversed
trigger3 = AnimElem = 6
trigger3 = !movecontact && !movereversed
attr = A, NA
damage    = 15,0
priority = 5, Hit
hitflag = MAFD
guardflag = HA
getpower = 28*(4+var(58)%4-(Random%5=0)),14*(4+var(58)%4-(Random%5=0))
givepower = 28*(6-var(58)%4-(Random%5=0)),14*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A),11,9),ifelse((p2statetype=A),11,16)
guard.pausetime = 9,9
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,0
animtype = hard
ground.type = high
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
ground.velocity = ifelse(p2dist X < 0,5*fvar(4),-5*fvar(4))
guard.velocity = ifelse(p2dist X < 0,5,-5)
air.velocity = ifelse(p2dist X < 0,0.5*fvar(4),-0.5*fvar(4)),-4.5
airguard.velocity = ifelse(p2dist X < 0,3,-3),-2
air.fall = 1
fall.recover = 1
fall.recovertime = 28 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
ground.cornerpush.veloff = -7*fvar(4)
air.cornerpush.veloff = -7*fvar(4)
guard.cornerpush.veloff = -10
airguard.cornerpush.veloff = -10
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 620
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 4

;---------------------[刃返し]
[state a]
type = changestate
triggerall = var(56) <= 254
trigger1 = !var(59)
trigger1 = movecontact
trigger1 = (command = "z") || (var(21) = [3,5])
trigger1 = AnimElemTime(8) < 0
value = 630


;---------------------------------------------------------------------------
;刃返し
[Statedef 630]
type    = A
movetype= A
physics = A
juggle  = 0
poweradd= 0
ctrl = 0
anim = 630
sprpriority = 1
hitcountpersist = 1

[state a]
type = ctrlset
trigger1 = animelemtime(7) = 0
value = 1

;---------------------[効果音]
[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 300, 5

[State 200, 1];鞘1
type = PlaySnd
trigger1 = animelemtime(5) = 0
value = 2200, 1

;---------------------[攻撃]
[State a]
type = TargetState
trigger1 = p2statetype = A
trigger1 = movehit = 1
value = 5701
ignorehitpause = 1

[State 630, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
trigger2 = !movecontact && !movereversed
attr = A, NA
damage    = 24,0
priority = 5, Hit
hitflag = MAFD
guardflag = HA
getpower = 28*(4+var(58)%4-(Random%5=0)),14*(4+var(58)%4-(Random%5=0))
givepower = 28*(6-var(58)%4-(Random%5=0)),14*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A),11,9),ifelse((p2statetype=A),11,16)
guard.pausetime = 9,9
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,0
animtype = back
ground.type = High
ground.slidetime = 16
guard.slidetime = 16
ground.hittime  = 16
ground.velocity = ifelse(p2dist X < 0,5*fvar(4),-5*fvar(4))
guard.velocity = ifelse(p2dist X < 0,5,-5)
air.velocity = ifelse(p2dist X < 0,10*fvar(4),-10*fvar(4)),25
airguard.velocity = ifelse(p2dist X < 0,3,-3),-2
air.fall = 1
fall.recover = 0
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
ground.cornerpush.veloff = -7*fvar(4)
air.cornerpush.veloff = -7*fvar(4)
guard.cornerpush.veloff = -10
airguard.cornerpush.veloff = -10
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 630
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 4

;---------------------------------------------------------------------------
;投げ
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 1

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[State 800]; 投げ抜け
type = ReversalDef
trigger1 = enemynear(var(2)),HitDefAttr = S,NT
reversal.attr = S,NT
p1stateno = 535
p2stateno = 536

[state a]; 投げ抜け強化
type = NotHitBy
trigger1 = p2bodydist X <= 20
value = S,NT

[State 800, 1]; 投げ抜け強化
type = HitDef
trigger1 = enemynear(var(2)),HitDefAttr = S,NT
trigger1 = p2bodydist X <= 20
attr = S,NT
hitflag = M
priority = 4, hit
sparkno = -1
sprpriority = 1
p1facing = 1
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
p1stateno = 535
p2stateno = 536
fall = 1
nochainID = 600,9999
ID = 800
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

[State 800, 1]
type = HitDef
Trigger1 = AnimElem = 2
;Trigger1 = p2stateno != 150 && 151 && 152 && 153 && 130 && 131 && 140
attr = S,NT          ;ｓ：立ち　ｎ：通常　ｔ：投げ
hitflag = M          ;コンボの途中から投げが入らないよう設定してある
priority = 4, hit    ;１は優先順位が低いので技がでないかミスするという設定
sparkno = -1          ;-をつければスパークエフェクトは無い
sprpriority = 1       ;２Ｐより上にカンフーマンが表示される
p1facing = 1
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
p1stateno = 801
p2stateno = 810       ;投げが成功した場合の移動する２Ｐのステート
fall = 1              ;落ちる力を２Ｐにかけるか
nochainID = 600,9999
ID = 800
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 260
ctrl = 1

;---------------------------------------------------------------------------
;投げ成功
[Statedef 801]
type    = A
movetype= A
physics = N
anim = 801
juggle  = 0
sprpriority = 2

[State 801]
type = Turn
triggerall = Time = 0
trigger1 = !var(59)
trigger1 = (command = "holdback") || (var(21) = 5)

[State AI]
type = Turn
triggerall = Time = 0
trigger1 = var(59)
trigger1 = backedgedist > frontedgedist

;---------------------[サウンド]
[State 810, Grab Sound];
type = PlaySnd
trigger1 = animelemtime(1) = 0
value = 800,1

[State 810, Grab Sound];どうしました？
type = PlaySnd
trigger1 = time = 0
value = 800,0
volume = 150
channel = 7

;---------------------[移動]
[state a]
type = velset
trigger1 = time = 1
x = 2.5
y = -1

[state a]
type = veladd
trigger1 = animelem = 6,<=0
y = 0.06

[state a]
type = velset
trigger1 = animelemtime(6) = 1
x = 2
y = -5

[state a]
type = veladd
trigger1 = animelem = 6,>=1
y = 0.45

;---------------------[相手制御]
[State 801, 2]
type = TargetBind
trigger1 = animelem = 1
pos = 40,0

[state a]
type = bindtotarget
trigger1 = animelem = 1
pos = 0,27,head

[state a]
type = targetstate
trigger1 = animelem = 1
value = 810

[State 801, 2]
type = TargetBind
trigger1 = AnimElemTime(6) = 0
pos = -77,-pos y

;---------------------[攻撃]
[State 801]
type = TargetState
trigger1 = movehit = 1
value = 5701
ignorehitpause = 1

[State 801, 3]
type = HitDef
trigger1 = animelem = 6
attr = A, NA
damage    = 36,0
priority = 5, Hit
guardflag = HA
getpower = 0,0
givepower = 0,0
pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,0
animtype = hard
ground.type = high
ground.slidetime = 19
ground.hittime  = 19
ground.velocity = 0,13
guard.velocity = -13
air.velocity = 0,13
fall = 1
fall.recover = 0
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
ID = 801 ;600
nochainID = 9999

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = time = 1
id = 7025
name = "hit"
pos = 14,-25
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -40, -floor(p2dist Y)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = floor(p2dist x/2 +15) , floor(p2dist y/2 -35)-(random%30)
postype = p1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;:::

[State 210, Width];画面端の押し戻し判定
type = null;Width
trigger1 = 1
edge = 40,0

[State 1];カメラ固定
type = null;screenbound
trigger1 = AnimElemTime(6) > 0
trigger1 = AnimElemTime(8) < 0
value = 0
;movecamera = 1,0

;---------------------[変数]
[state a];Pゲージ
type = VarAdd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = -1

[State S]; EnemyEscape
type = TargetState
triggerall = AnimElemTime(2) < 5
triggerall = enemynear(var(2)),command = "z"
trigger1 = enemynear(var(2)),command = "holdfwd"
trigger2 = enemynear(var(2)),command = "holdback"
value = 536

[State S]; EnemyEscape
type = ChangeState
triggerall = AnimElemTime(2) < 5
triggerall = enemynear(var(2)),command = "z"
trigger1 = enemynear(var(2)),command = "holdfwd"
trigger2 = enemynear(var(2)),command = "holdback"
value = 535

[State 00]
type = ChangeState
triggerall = AnimElemTime(7) > 0
triggerall = Vel Y > 0
trigger1 = Pos Y >= -30
value = 52

;---------------------------------------------------------------------------
;(ENEMY)掴まれ
[Statedef 810]
type    = S
movetype= H
physics = N
velset = 0,0
sprpriority = -1

[state a]
type = turn
trigger1 = facing = enemy,facing
trigger1 = time = 0

[state a]
type = velset
trigger1 = time = 0
x = -3

[State 700, 2];無敵の状態を作る
type = NotHitBy
trigger1 = animelem = 5,<=0
value = SCA

[State 1];カメラ固定
type = null;screenbound
trigger1 = 1
value = 0

[state a]
type = velmul
trigger1 = 1
x = 0.94

[State 810]
type = velset
trigger1 = Time = 20
x = 0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 810

[State 210, Width];画面端の押し戻し判定
type = Width
trigger1 = 1
edge = 0,40

[State 810]
type = StateTypeSet
trigger1 = AnimElemTime(5) = 0
type = A

[State 810]
type = SelfState
trigger1 = AnimElemTime(5) > 7
value = 5070


;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;必殺技
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
; 凪風
[Statedef 1000]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 1000
sprpriority = 1
ctrl = 0

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = animelem = 4,<=0
value = SCA
time = 1

;---------------------[効果音]
[state a];凪風
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1000,0
volume = 150

[state a];振り
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1000,1

;---------------------[速度]
[state a]
type = VelSet
trigger1 = Time = 0
trigger1 = prevstateno = 20
trigger2 = AnimElemTime(11) = 0
trigger2 = vel X > 0
x = 0

[state a]
type = VelSet
trigger1 = AnimElemTime(5) = 0
x = 1.5

[state a, ground.cornerpush]
type = VelSet
trigger1 = var(27) = 9
trigger1 = (p2statetype = S) || (p2statetype = C) 
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -4*fvar(4)

[state a]
type = StateTypeSet
trigger1 = vel X < 0
physics = S

;---------------------[攻撃]
[State 1000, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 4
trigger2 = animelem = 5
trigger3 = animelem = 6
attr = S, SA
damage    = 20,0
priority = 5, Hit
animtype  = hard
hitflag = MAFD
guardflag = MA
getpower = 3*(4+var(58)%4-(Random%5=0)),2*(4+var(58)%4-(Random%5=0))
givepower = 3*(6-var(58)%4-(Random%5=0)),2*(6-var(58)%4-(Random%5=0))
pausetime = ifelse(((p2statetype=A)||(p2statetype=L)||((enemynear,hitfall)&&(prevstateno=420))),9,7),ifelse(((p2statetype=A)||(p2statetype=L)||((enemynear,hitfall)&&(prevstateno=420))),9,14)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = -20,-50
hitsound   = s400,3
guard.sparkno = s-1
guardsound = s120,1
ground.type = high
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
yaccel = 0.38
ground.velocity = ifelse((enemynear,hitfall)&&(prevstateno=420),-1*fvar(4),-4*fvar(4)),ifelse((enemynear,hitfall)&&(prevstateno=420),-4.6,0)
guard.velocity = -4
air.velocity = -1*fvar(4),-4.5
airguard.velocity = -3,-2
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -4*fvar(4)
down.cornerpush.veloff = -4*fvar(4)
guard.cornerpush.veloff = -6
airguard.cornerpush.veloff = -6
envshake.time = 2
envshake.freq = 100
envshake.ampl = 1
ID = 200
nochainID = 9999

[State 1000, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 8
attr = S, SA
damage    = 13,0
priority = 5, Hit
animtype  = hard
hitflag = MAFD
guardflag = MA
getpower = 3*(4+var(58)%4-(Random%5=0)),2*(4+var(58)%4-(Random%5=0))
givepower = 3*(6-var(58)%4-(Random%5=0)),2*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A),9,7),ifelse((p2statetype=A),9,14)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = -20,-50
hitsound   = s400,3
guard.sparkno = s-1
guardsound = s120,1
ground.type = low
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
yaccel = 0.38
ground.velocity = -5*fvar(4)
guard.velocity = -5
air.velocity = -1*fvar(4),-5.2
airguard.velocity = -3,-2
air.fall = 1
fall.recover = 1
fall.recovertime = 34 ;25
fall.xvelocity = 0
fall.yvelocity = -3.4
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -4*fvar(4)
down.cornerpush.veloff = -4*fvar(4)
guard.cornerpush.veloff = -10.8
airguard.cornerpush.veloff = -10.8
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4
ID = 200
nochainID = 9999

;---------------------[]
[State explod];エフェクト
type = Explod
trigger1 = animelemtime(4) = 0
anim = 6040
id = 3000
sprpriority = 4
postype = p1
pos = 115,-27
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0
trans = addalpha
alpha = 256,256

[State explod];エフェクト
type = Explod
trigger1 = animelemtime(4) = 0
anim = 6040
id = 3000
sprpriority = 4
postype = p1
pos = 110,-98
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0
trans = addalpha
alpha = 256,256

[State explod];エフェクト
type = Explod
trigger1 = animelemtime(5) = 0
anim = 6040
id = 3000
sprpriority = 4
postype = p1
pos = 120,-54
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0
trans = addalpha
alpha = 256,256

[State explod];エフェクト
type = Explod
trigger1 = animelemtime(5) = 0
anim = 6040
id = 3000
sprpriority = 4
postype = p1
pos = 75,-123
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0
trans = addalpha
alpha = 256,256

[State explod];エフェクト
type = Explod
trigger1 = animelemtime(6) = 0
anim = 6040
id = 3000
sprpriority = 4
postype = p1
pos = -36,-105
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0
trans = addalpha
alpha = 256,256

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit = 1
trigger1 = animelem = 4,>=0 && animelem = 5,<0
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 30) , floor(p2dist y/2 -55)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト
type = Helper
trigger1 = movehit = 1
trigger1 = animelem = 5,>=0 && animelem = 6,<0
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 30) , floor(p2dist y/2 -55)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト
type = Helper
trigger1 = movehit = 1
trigger1 = animelem = 6,>=0 && animelem = 7,<0
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 30) , floor(p2dist y/2 -55)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト
type = Helper
trigger1 = movehit = 1
trigger1 = animelem = 7,>=0
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 30) , floor(p2dist y/2 -55)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded = 1
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 9999
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 7

;---------------------[立ちステートに戻る]
[state a]
type = changestate
triggerall = var(56) <= 245
trigger1 = !var(59)
trigger1 = movecontact
trigger1 = (command = "中月華") || (var(21) = 14)
value = 1201

[state a]
type = changestate
trigger1 = !var(59)
trigger1 = movecontact
trigger1 = command = "holdup"
value = 40

[state a]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; 月華・弱
[Statedef 1200]
type    = S
movetype= A
physics = N
juggle  = 0
poweradd= 0
velset = 0,0
anim = 1200
sprpriority = 1
ctrl = 0

[State 860]
type = ChangeAnim
triggerall = var(9)
triggerall = Time = 0
trigger1 = prevstateno = 860
value = 1200
elem = 5

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

;---------------------[速度]
[state a]
type = VelSet
trigger1 = AnimElemTime(7) = 0
x = 8

[state a]
type = VelMul
trigger1 = AnimElemTime(8) > 0
x = 0.7

;---------------------[]
[State explod];エフェクト
type = Explod
trigger1 = animelemtime(7) = 0
anim = 6002
id = 3000
sprpriority = 4
postype = p1
pos = -30,0
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 12

;---------------------[立ちステートに戻る]
[state a]
type = changestate
trigger1 = animtime = 0
value = 1205

;---------------------------------------------------------------------------
; 月華・弱・攻撃
[Statedef 1205]
type    = A
movetype= A
physics = N
juggle  = 0
poweradd= 0
anim = 1205
sprpriority = 1
ctrl = 0
hitcountpersist = 1

[State 860, P Gauge]
type = VarAdd
triggerall = var(9)
trigger1 = var(57) = 1
trigger1 = movehit = 1
var(56) = ifelse(var(9)=1, 0, -30)

[State 860]
type = VarSet
trigger1 = AnimTime = 0
var(9) = 0

;---------------------[効果音]
[state a];
type = playsnd
trigger1 = animelemtime(1) = 0
value = 1200,1

[state a];はっ
type = playsnd
trigger1 = animelemtime(1) = 0
value = 1200,0
volume = 150

[state a];鞘2
type = playsnd
trigger1 = animelemtime(8) = 0
value = 300,6

;---------------------[速度]
[state a]
type = Gravity
trigger1 = AnimElemTime(3) > 0

[state a]
type = VelSet
trigger1 = time = 0
x = 5
y = -3.5

[state a]
type = VelSet
trigger1 = AnimElemTime(5) = 0
x = 4

;---------------------[攻撃]
[State a]; 弱=>強・非復帰判定
type = VarAdd
triggerall = AnimElemTime(3) = 0
trigger1 = p2statetype != A
trigger2 = !enemynear,GetHitVar(fall.recover)
var(20) = 100

[State a]
type = VarAdd
triggerall = AnimElemTime(3) = 0
trigger1 = var(20) >= 100
trigger1 = numtarget(1205) || numtarget(1250)
var(20) = -100

[State 1205, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 3
attr = A, SA
damage    = 47,0
priority = 8, Hit
hitflag = MAFD
guardflag = MA
getpower = 20*(4+var(58)%4-(Random%5=0)),10*(4+var(58)%4-(Random%5=0))
givepower = 20*(6-var(58)%4-(Random%5=0)),10*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,7)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = hard
ground.type = high
ground.slidetime = 16
guard.slidetime = 16
ground.hittime  = 16
ground.velocity = -1.6,-7
guard.velocity = -8
air.velocity = -0.5,-6
airguard.velocity = -3,-2
fall = 1
fall.recover = 1
fall.recovertime = ifelse((p2statetype=A)||(p2statetype=L),34,32) ;25
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 1205
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[State explod];ジャンプエフェクト
type = Explod
trigger1 = Time = 0
anim = 6000
id = 3000
sprpriority = 2
postype = p1
pos = 0,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト2
type = Helper
trigger1 = movehit
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 25) , floor(p2dist y/2 -65)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[ヘルパー]
[state a];エフェクト2
type = Helper
trigger1 = animelemtime(3) = 0
id = 6051
name = "hit2"
sprpriority = 2
pos = 0,0
postype = p1
stateno = 6051
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

;---------------------[立ちステートに戻る]
[state a]
type = CtrlSet
trigger1 = AnimElemTime(9) = 0
value = 1

[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= -10
value = 52


;---------------------------------------------------------------------------
; 着地
[Statedef 1210]
type    = S
physics = N
ctrl = 0
anim = 1211
velset = 0,0

[State 1420]
type = ChangeAnim
trigger1 = prevstateno = 1421
trigger1 = Time = 0
value = 1422

[State 01]
type = PosSet
trigger1 = Time = 0
y = 0

;---------------------[効果音]
[State 00]
type = PlaySnd
trigger1 = time = 0
value = 40, 0

[State 00]; 鞘2
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
value = 300, 6

[State explod];エフェクト
type = Explod
trigger1 = time = 0
anim = 6001
id = 3000
sprpriority = 2
postype = p1
pos = 0,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

[state a]
type = Turn
trigger1 = AnimElemTime(5) >= 0
trigger1 = p2dist X < 0

[state a]
type = CtrlSet
trigger1 = AnimElemTime(5) = 0
value = 1

[State 03]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; 月華・中、強
[Statedef 1201]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 1201
sprpriority = 1
ctrl = 0

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[state a]
type = VarSet
trigger1 = time = 0
var(5) = 0

[state a]
type = VarSet
triggerall = time = 0
trigger1 = !var(59)
trigger1 = (command = "z") || (var(21) = 15)
var(5) = 1

[State AI]
type = VarSet
triggerall = time = 0
trigger1 = var(59)
trigger1 = prevstateno != 1000
trigger1 = (p2bodydist Y < -140+10*(enemynear(var(2)),vel Y<0)) || (((prevstateno = 420)||(prevstateno = 210)) && (p2bodydist X < 70))
trigger1 = p2movetype != A
var(5) = 1

[state a]
type = changeanim
trigger1 = time = 0
trigger1 = var(5) = 1
value = 1202

[State 1201];中月華無敵判定
type = NotHitBy
trigger1 = var(5) = 0
value = SCA

;---------------------[速度]
[state a]
type = velset
trigger1 = time = 0
trigger1 = prevstateno = 20
x = 0

;---------------------[]
[State explod];エフェクト
type = Explod
trigger1 = animtime = -1
anim = 6002
id = 3000
sprpriority = 4
postype = p1
pos = -20,0
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

[State explod];エフェクト
type = Explod
trigger1 = animtime = -1
anim = 6002
id = 3000
sprpriority = 4
facing = -1
postype = p1
pos = 20,0
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

;---------------------[変数]
[state a];Pゲージ
type = VarAdd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 15+3*(var(5)=0)

;---------------------[立ちステートに戻る]
[state a]
type = changestate
trigger1 = animtime = 0
value = 1206

;---------------------------------------------------------------------------
; 月華・中、強・攻撃
[Statedef 1206]
type    = A
movetype= A
physics = N
velset = 0,0
anim = 1206
sprpriority = 1
ctrl = 0

[State 860, P Gauge]
type = VarAdd
triggerall = var(9)
trigger1 = var(57) = 1
trigger1 = movehit = 1
var(56) = ifelse(var(9)=1, 0, -30)

[State 860]
type = VarSet
trigger1 = AnimTime = 0
var(9) = 0

[state a]
type = changeanim
trigger1 = time = 0
trigger1 = var(5) = 1
value = 1207

[State 1206];中月華無敵判定
type = NotHitBy
trigger1 = var(5) = 0
trigger1 = AnimElemTime(2) < 1
value = SCA

;---------------------[効果音]
[state a];はっ
type = playsnd
trigger1 = animelemtime(1) = 0
value = 1200,0
volume = 150

[state a];
type = playsnd
trigger1 = animelemtime(1) = 0
value = 1200,1

;---------------------[速度]
[state a]
type = Gravity
trigger1 = AnimElemTime(2) > 1

;-----------(中)
[state a]
type = VelSet
trigger1 = time = 0
trigger1 = var(5) = 0
x = 12
y = -20

[state a]
type = VelMul
triggerall = var(5) = 0
trigger1 = AnimElemTime(1) > 0
trigger1 = AnimElemTime(2) < 0
y = 0.5

[state a]
type = VelSet
triggerall = var(5) = 0
trigger1 = AnimElemTime(2) = 1
x = 1.5
y = -4.2

;-----------(強)
[state a]
type = VelSet
triggerall = var(5) = 1
trigger1 = time = 0
x = 12
y = -27

[state a]
type = VelMul
triggerall = var(5) = 1
trigger1 = AnimElemTime(1) > 0
trigger1 = AnimElemTime(2) < 0
y = 0.5

[state a]
type = VelSet
triggerall = var(5) = 1
trigger1 = AnimElemTime(2) = 0
x = -1.5

[state a]
type = VelSet
triggerall = var(5) = 1
trigger1 = AnimElemTime(2) = 1
y = -5.5

;---------------------[攻撃]
[State 1206, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 2
trigger1 = var(5) = 0
attr = A, SA
damage    = 55,0
priority = 8, Hit
hitflag = MAFD
guardflag = MA
getpower = 20*(4+var(58)%4-(Random%5=0)),10*(4+var(58)%4-(Random%5=0))
givepower = 20*(6-var(58)%4-(Random%5=0)),10*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,7)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = hard
ground.type = high
ground.slidetime = 10
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -1.5,-6
guard.velocity = -7
air.velocity = -0.5,-6
airguard.velocity = -2,-1.23
fall = 1
fall.recover = ifelse((p2statetype=A)&&((!enemynear,hitfall)||(enemynear,GetHitVar(fall.recover))),1,0) ;原作では常に1
fall.recovertime = ifelse((p2statetype=A)||(p2statetype=L),34,32) ;25
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 1206
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

[State a]; 復帰判定
type = VarSet
triggerall = AnimElemTime(3) = 0
triggerall = var(5) = 1
triggerall = p2statetype = A
triggerall = !enemynear,hitfall || enemynear,GetHitVar(fall.recover)
trigger1 = var(20) >= 100
trigger1 = !numtarget(1205) && !numtarget(1250)
trigger2 = !var(20)
var(20) = 10

[State a]; バウンド
type = TargetState
trigger1 = movehit = 1
trigger1 = var(5) = 1
trigger1 = var(20)%10 = 0
value = 5701
ignorehitpause = 1

[State a]; バウンド判定
type = VarAdd
trigger1 = movehit = 1
trigger1 = var(5) = 1
var(20) = 1

[State 1206, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 2
trigger1 = var(5) = 1
attr = A, SA
damage    = 47,0
priority = 8, Hit
hitflag = MAFD
guardflag = MA
getpower = 8*(4+var(58)%4-(Random%5=0)),4*(4+var(58)%4-(Random%5=0))
givepower = 8*(6-var(58)%4-(Random%5=0)),4*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,7)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = back
ground.type = high
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
ground.velocity = -10,25
guard.velocity = -5
air.velocity = -10,25
airguard.velocity = -2,-1.23
fall = 1
fall.recover = 0
fall.xvelocity = 0
fall.yvelocity = 0
yaccel = 0.38
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -12
guard.cornerpush.veloff = -12
airguard.cornerpush.veloff = -12
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 1200
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト2
type = Helper
trigger1 = movehit
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 25) , floor(p2dist y/2 -65)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];強・追加攻撃
type = Helper
trigger1 = movehit = 1
trigger1 = var(5) = 1
trigger1 = HitShakeOver
id = 1220
name = "hit"
pos = 0,-60
postype = p1
stateno = 1220
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 0
keyctrl = 0 
ownpal = 1

[state a];エフェクト2
type = Helper
trigger1 = animelemtime(2) = 0
id = 6051
name = "hit2"
sprpriority = 2
pos = 0,0
postype = p1
stateno = 6051
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

;---------------------[立ちステートに戻る]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = var(5) = 0
trigger1 = Pos Y >= -20
trigger2 = var(5) = 1
trigger2 = Pos Y >= -10
value = 1210


;---------------------------------------------------------------------------
; 月華（空中版）
[Statedef 1250]
type    = A
movetype= A
physics = N
anim = 1250
sprpriority = 1
ctrl = 0

;---------------------[変数]
[state a]
type = VarSet
triggerall = time = 0
trigger1 = !var(59)
trigger1 = (command = "x") || (var(21) = 13)
v = 5
value = 0

[state a]
type = VarSet
triggerall = time = 0
trigger1 = !var(59)
trigger1 = (command = "y") || (var(21) = 14)
v = 5
value = 1

[state a]
type = VarSet
triggerall = time = 0
trigger1 = !var(59)
trigger1 = (command = "z") || (var(21) = 15)
v = 5
value = 2

[State AI, Light]
type = VarSet
triggerall = time = 0
triggerall = var(59)
triggerall = var(56) < 240
trigger1 = prevstateno != 1250
trigger2 = numhelper(6050)
trigger2 = helper(6050),time >= 10 ;6
v = 5
value = 0

[State AI, Hard]
type = VarSet
triggerall = time = 0
triggerall = var(59)
trigger1 = numtarget(600) || numtarget(610) || numtarget(620) || numtarget(1205)
trigger1 = var(58)%40 = (0,20]
trigger2 = numtarget(630)
trigger2 = p2bodydist Y < -80
trigger3 = prevstateno = 1250
trigger3 = numhelper(6050)
trigger3 = helper(6050),time < 10 ;6
v = 5
value = 2

[State AI, Middle]
type = VarSet
triggerall = time = 0
triggerall = var(59)
trigger1 = p2movetype = A
trigger1 = p2bodydist X = [-20,80]
trigger1 = p2bodydist Y = [-60,70]
trigger2 = numtarget(600) || numtarget(610) || numtarget(620) || numtarget(1205)
trigger2 = var(58)%40 = 0
trigger3 = numtarget(630)
trigger3 = p2bodydist Y < -80
trigger3 = var(20)%10
trigger3 = Random%2 = 0
trigger4 = prevstateno = 1250
trigger4 = numhelper(6050)
trigger4 = helper(6050),time < 10 ;6
trigger4 = var(20)%10
trigger4 = Random%2 = 0
trigger5 = var(56) >= 249
v = 5
value = 1

[state a]
type = ChangeAnim
triggerall = Time = 0
trigger1 = var(5) != 0
value = 1250 + var(5)

[State 1250];中月華無敵判定
type = NotHitBy
trigger1 = var(5) = 1
trigger1 = AnimElemTime(3) < 1
value = SCA

;---------------------[効果音]
[state a];はっ
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1200,0
volume = 150

[state a];
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1200,1

[state a]; 鞘2
type = PlaySnd
trigger1 = Anim = 1250
trigger1 = AnimElemTime(8) = 2
value = 300,6

;---------------------[速度]
;------------(弱)
[state a]
type = Gravity
trigger1 = var(5) = 0

[state a]
type = VelSet
triggerall = var(5) = 0
trigger1 = AnimElemTime(3) = 0
y = -3

;-----------(中)
[state a]
type = Gravity
triggerall = var(5) = 1
trigger1 = AnimElemTime(3) > 1

[state a]
type = VelSet
triggerall = var(5) = 1
trigger1 = time = 0
x = 0
y = 0

[state a]
type = VelSet
triggerall = var(5) = 1
trigger1 = AnimElemTime(2) = 0
x = 4
y = -12

[state a]
type = VelMul
triggerall = var(5) = 1
trigger1 = AnimElemTime(2) > 0
trigger1 = AnimElemTime(3) < 0
y = 0.5

[state a]
type = VelSet
triggerall = var(5) = 1
trigger1 = AnimElemTime(3) = 0
x = 0.8
y = -1.8

;-----------(強)
[state a]
type = Gravity
triggerall = var(5) = 2
trigger1 = AnimElemTime(2) < 0
trigger2 = AnimElemTime(3) > 1

[state a]
type = VelSet
triggerall = var(5) = 2
trigger1 = time = 0
x = 0
y = 1

[state a]
type = VelSet
triggerall = var(5) = 2
trigger1 = AnimElemTime(2) = 0
x = 6
y = -12

[state a]
type = VelMul
triggerall = var(5) = 2
trigger1 = AnimElemTime(2) > 0
trigger1 = AnimElemTime(3) < 0
y = 0.5

[state a]
type = VelSet
triggerall = var(5) = 2
trigger1 = AnimElemTime(3) = 0
x = -2

[state a]
type = VelSet
triggerall = var(5) = 2
trigger1 = AnimElemTime(3) = 1
y = -3.6

;---------------------[攻撃]
[State a]; 弱=>強・非復帰判定
type = VarAdd
triggerall = AnimElemTime(3) = 0
triggerall = var(5) = 0
trigger1 = p2statetype != A
trigger2 = !enemynear,GetHitVar(fall.recover)
var(20) = 100

[State a]
type = VarAdd
triggerall = AnimElemTime(3) = 0
triggerall = var(5) = 0
trigger1 = var(20) >= 100
trigger1 = numtarget(1205) || numtarget(1250)
var(20) = -100

[State 1250, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 3
trigger1 = var(5) = 0
attr = A, SA
damage    = 15,0
priority = 8, Hit
hitflag = MAFD
guardflag = MA
getpower = 20*(4+var(58)%4-(Random%5=0)),10*(4+var(58)%4-(Random%5=0))
givepower = 20*(6-var(58)%4-(Random%5=0)),10*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,7)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = hard
ground.type = high
ground.slidetime = 10
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -0.5,-5
guard.velocity = -5
air.velocity = -0.5,-4.5
airguard.velocity = -2,-1.23
fall = 1
fall.recover = 1
fall.recovertime = ifelse((p2statetype=A)||(p2statetype=L),26,24) ;17
fall.xvelocity = 0
fall.yvelocity = -3.4
yaccel = 0.38
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 1250
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

[State a]
type = TargetState
triggerall = var(5) = 1
trigger1 = movehit = 1
value = 5701
ignorehitpause = 1

[State 1250, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 3
trigger1 = var(5) = 1
attr = A, SA
damage    = 41,0
priority = 8, Hit
hitflag = MAFD
guardflag = MA
getpower = 20*(4+var(58)%4-(Random%5=0)),10*(4+var(58)%4-(Random%5=0))
givepower = 20*(6-var(58)%4-(Random%5=0)),10*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,7)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = back
ground.type = high
ground.slidetime = 10
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -10,25
guard.velocity = -5
air.velocity = -10,25
airguard.velocity = -2,-1.23
fall = 1
fall.recover = 0
fall.xvelocity = 0
fall.yvelocity = -4.5
yaccel = 0.38
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 1251
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

[State a]; 復帰判定
type = VarSet
triggerall = AnimElemTime(3) = 0
triggerall = var(5) = 2
triggerall = p2statetype = A
triggerall = !enemynear,hitfall || enemynear,GetHitVar(fall.recover)
trigger1 = var(20) >= 100
trigger1 = !numtarget(1205) && !numtarget(1250)
trigger2 = !var(20)
var(20) = 10

[State a]; バウンド
type = TargetState
trigger1 = movehit = 1
trigger1 = var(5) = 2
trigger1 = var(20)%10 = 0
value = 5701
ignorehitpause = 1

[State a]; バウンド判定
type = VarAdd
trigger1 = movehit = 1
trigger1 = var(5) = 2
var(20) = 1

[State 1250, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 3
trigger1 = var(5) = 2
attr = A, SA
damage    = 47,0
priority = 8, Hit
hitflag = MAFD
guardflag = MA
getpower = 8*(4+var(58)%4-(Random%5=0)),4*(4+var(58)%4-(Random%5=0))
givepower = 8*(6-var(58)%4-(Random%5=0)),4*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,7)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = back
ground.type = high
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
ground.velocity = -10,25
guard.velocity = -5
air.velocity = -10,25
airguard.velocity = -2,-1.23
fall = 1
fall.recover = 0
fall.xvelocity = 0
fall.yvelocity = 0
yaccel = 0.38
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -12
guard.cornerpush.veloff = -12
airguard.cornerpush.veloff = -12
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 1200
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト2
type = Helper
trigger1 = movehit
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 25) , floor(p2dist y/2 -65)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];強・追加攻撃
type = Helper
trigger1 = movehit = 1
trigger1 = var(5) = 2
trigger1 = HitShakeOver
id = 1220
name = "hit"
pos = 0, -60
postype = p1
stateno = 1220
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];エフェクト2
type = Helper
trigger1 = animelemtime(3) = 0
id = 6051
name = "hit2"
sprpriority = 2
pos = 0,0
postype = p1
stateno = 6051
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 9+9*(var(5)=0)

;---------------------[立ちステートに戻る]
[state a]
type = CtrlSet
trigger1 = animelemtime(9) = 0
trigger1 = var(5) = 0
value = 1

[state a]
type = changestate
triggerall = !var(59)
triggerall = var(5) = 0
triggerall = var(56) <= 249
triggerall = movecontact
trigger1 = (command = "中月華") || (command = "強月華")
trigger2 = AnimElemTime(3) > 0
trigger2 = AnimElemTime(4) < 0
trigger2 = (command = "y") || (command = "z")
value = 1250

[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= -20
value = ifelse(var(5)=0, 52, 1210)


;---------------------------------------------------------------------------
;(ENEMY)吹き飛び(桜月華)
[Statedef 1229]
type    = A
movetype= H
physics = N
sprpriority = 1

[state a]
type = turn
trigger1 = p2dist x < 0
trigger1 = time = 0

[state a]
type = VelSet
trigger1 = time = 0
x = -12
y = -4

[state a]
type = VelAdd
trigger1 = 1
y = 0.38

[state a]
type = playerpush
trigger1 = 1
value = 0

[state a]
type = null;AfterImage
trigger1 = time = 1
time = -1
length = 8
timegap = 1
framegap = 1
palbright = 0,0,0
palcontrast = 128,128,128
paladd = 0,0,0
palmul = .65,.65,.65
trans = addalpha

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1230

[state a]
type = changestate
trigger1 = BackEdgeDist <= 10
trigger2 = time = 200
trigger3 = frontEdgeDist <= 10
value = 1232

[State 821, 3] 
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;---------------------------------------------------------------------------
;(ENEMY)吹き飛び(強月華)＜復帰なし＞
[Statedef 1230]
type    = A
movetype= H
physics = N
sprpriority = 1

[state a]
type = turn
trigger1 = p2dist x < 0
trigger1 = time = 0

[state a]
type = VelSet
trigger1 = time = 0
x = -10
y = 0

[state a]
type = playerpush
trigger1 = 1
value = 0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1230

[state a]
type = changestate
trigger1 = BackEdgeDist <= 10
trigger2 = time = 200
trigger3 = frontEdgeDist <= 10
value = 1232

[State 821, 3] 
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;---------------------------------------------------------------------------
;(ENEMY)吹き飛び(強月華)＜復帰あり＞
[Statedef 1231]
type    = A
movetype= H
physics = N
sprpriority = 1

[state a]
type = turn
trigger1 = p2dist x < 0
trigger1 = time = 0

[state a]
type = VelSet
trigger1 = time = 0
x = -10
y = 0

[state a]
type = playerpush
trigger1 = 1
value = 0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1230

[state a]
type = changestate
trigger1 = BackEdgeDist <= 10
trigger2 = time = 200
trigger3 = frontEdgeDist <= 10
value = 1233

[State 821, 3] 
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100


;---------------------------------------------------------------------------
;(ENEMY)落下＜復帰なし＞
[Statedef 1232]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1231

[State -1]
type = EnvShake
trigger1 = Time = 0
time = 8
freq = 100
ampl = 4

[State -1]
type = Explod
trigger1 = Time = 0
anim = F70
pos = -const(size.air.back),const(size.mid.pos.y)
postype = p1
removetime = 17
ontop = 1
supermovetime = 99999
pausemovetime = 99999
ownpal = 1
persistent = 0

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 0
value = F7,1

[state a]
type = VelSet
trigger1 = AnimElemTime(2) = 0
x = 2
y = -3.8+2.1*(prevstateno=1229)

[state a]
type = VelAdd
trigger1 = AnimElemTime(2) > 0
y = 0.38

[State 821, 3]
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;---------------------------------------------------------------------------
;(ENEMY)落下＜復帰あり＞
[Statedef 1233]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1231

[State -1]
type = EnvShake
trigger1 = Time = 0
time = 8
freq = 100
ampl = 4

[State -1]
type = Explod
trigger1 = Time = 0
anim = F70
pos = -const(size.air.back),const(size.mid.pos.y)
postype = p1
removetime = 17
ontop = 1
supermovetime = 99999
pausemovetime = 99999
ownpal = 1
persistent = 0

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 0
value = F7,1

[state a]
type = VelSet
trigger1 = AnimElemTime(2) = 0
x = 2
y = -3.8

[state a]
type = VelAdd
trigger1 = AnimElemTime(2) > 0
y = 0.38

[State 821, 3]
type = SelfState
trigger1 = Time > 38
value = 5050

[State 821, 3]
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100


;---------------------------------------------------------------------------
; 息吹
[Statedef 1400]
type    = S
movetype= A
physics = S
vel = 0,0
anim = 1400
sprpriority = 1
ctrl = 0

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[state a]
type = VarSet
trigger1 = time = 0
v = 5
value = 0

[state a]
type = VarSet
trigger1 = AnimTime = 0
trigger2 = prevstateno != [5000,5100]
var(9) = 0

[state a];紫重閃
type = VarSet
trigger1 = !var(59)
trigger1 = var(9) = 0
trigger1 = animelem = 5,>=0
trigger1 = movecontact
trigger1 = ((command = "holdback") && (command = "z")) || (var(21) = 5)
v = 5
value = 1

[state a];桜月華
type = VarSet
trigger1 = !var(59)
trigger1 = var(9) = 0
trigger1 = animelem = 5,>=0
trigger1 = movecontact
trigger1 = ((command = "holdfwd") && (command = "z")) || (var(21) = 4)
v = 5
value = 2

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = var(9)
value = SCA
time = 1

;---------------------[速度]
[state a, ground.cornerpush]
type = VelSet
triggerall = var(9) = 0
trigger1 = var(27) = 8
trigger1 = (p2statetype = S) || (p2statetype = C) 
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -8*fvar(4)

;---------------------[効果音]
[state a];ｼｯ！
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1400,0
volume = 150

[state a];振り
type = playsnd
triggerall = var(9) = 0
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(5) = 0
value = 300,1

[state a];振り
type = playsnd
triggerall = var(9) = 0
trigger1 = animelemtime(2) = 0
value = 300,2

[state 860];緋空閃
type = playsnd
triggerall = var(9)
trigger1 = Time = 1
trigger1 = Random < 500
value = 860,0
volume = 150

[state 860]
type = playsnd
triggerall = var(9)
trigger1 = animelemtime(2) = 0
value = 1300,0

[state 860]
type = playsnd
triggerall = var(9)
trigger1 = animelemtime(5) = 0
value = 300,2

[state 860]
type = playsnd
triggerall = var(9)
trigger1 = animelemtime(9) = 0
value = 400,2

[state 860]
type = playsnd
triggerall = var(9)
trigger1 = animelemtime(9) = 0
value = s520,1
volume = -125

[state a];鞘
type = playsnd
trigger1 = animelemtime(10) = 0
value = 300,6

;---------------------[攻撃]
[State 1400, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = var(9) = 0
trigger1 = animelem = 3
attr = S, SA
damage    = 26,0
priority = 7, Hit
animtype  = hard
hitflag = MAFD
guardflag = MA
getpower = 6*(4+var(58)%4-(Random%5=0)),3*(4+var(58)%4-(Random%5=0))
givepower = 6*(6-var(58)%4-(Random%5=0)),3*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,14)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = -20,-60
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
ground.type = high
ground.slidetime = 30 ;16
guard.slidetime = 16
ground.hittime  = 16
ground.velocity = -7*fvar(4)
guard.velocity = -6
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -3,-2
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
yaccel = 0.38
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -8*fvar(4)
down.cornerpush.veloff = -8*fvar(4)
guard.cornerpush.veloff = -7
airguard.cornerpush.veloff = -7
ID = 200
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

[State 1400]
type = MoveHitReset
trigger1 = AnimElemTime(4) = 1

[State 1400, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = var(9) = 0
trigger1 = animelem = 5
attr = S, SA
damage    = 26,0
priority = 7, Hit
animtype  = hard
hitflag = MAF
guardflag = MA
getpower = 6*(4+var(58)%4-(Random%5=0)),3*(4+var(58)%4-(Random%5=0))
givepower = 6*(6-var(58)%4-(Random%5=0)),3*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,14)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = -20,-50
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
ground.type = low
ground.slidetime = 16
guard.slidetime = 16
ground.hittime  = 16
ground.velocity = -7*fvar(4)
guard.velocity = -6
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -3,-2
yaccel = 0.38
air.fall = 1
fall.recover = 1
fall.recovertime = 26 ;17
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = -8*fvar(4)
down.cornerpush.veloff = -8*fvar(4)
guard.cornerpush.veloff = -14
airguard.cornerpush.veloff = -14
ID = 200
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

;---------------------[緋空閃]
[State 860]
type = AssertSpecial
trigger1 = var(9)
flag = unguardable

[State 860]
type = HitDef
triggerall = var(9)
trigger1 = animelem = 3
trigger2 = animelem = 5
attr = S, SA
damage    = 0,0
priority = 7, Hit
animtype  = hard
hitflag = MAFD
guardflag = MA
pausetime = 1,30
sparkno = -1
sparkxy = -20,-60
hitsound   = -1
guard.sparkno = -1
guardsound = -1
ground.type = high
ground.slidetime = 19
ground.hittime  = 19
ground.velocity = 0
air.velocity = -0.5,-3.
fall = 1
fall.recover = 0
yaccel = 0.38
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ID = 860
nochainID = 9999

[State 860]
type = TargetState
triggerall = var(9)
trigger1 = AnimElem = 9
value = 5704

[State 860]
type = TargetLifeAdd
triggerall = var(9)
trigger1 = AnimElemTime(9) = 1
value = -ceil(1.5*(var(29)-Life))

[State 860]
type = TargetPowerAdd
triggerall = var(9)
trigger1 = AnimElemTime(9) = 1
value = ceil(0.6*(var(29)-Life))

[State 860]
type = PowerAdd
triggerall = var(9)
trigger1 = AnimElemTime(9) = 1
value = ceil(1.05*(var(29)-Life))

[State 860, P Gauge]
type = VarAdd
triggerall = var(9)
trigger1 = var(57) = 1
trigger1 = AnimElemTime(9) = 1
var(56) = ifelse(var(9)=1, -30, -60)

[State 860]
type = Pause
trigger1 = var(9)
trigger1 = Time = 0
time = 15
movetime = 15

[State 860]
type = Pause
triggerall = RoundState = 2
trigger1 = var(9)
trigger1 = AnimElemTime(8) = 1
time = 30

[State 860]
type = Pause
triggerall = RoundState = 2
trigger1 = var(9)
trigger1 = AnimElemTime(9) > 0
trigger1 = AnimElemTime(10) <= 0
time = 2

[State 860]
type = Pause
triggerall = RoundState = 2
trigger1 = var(9)
trigger1 = AnimElemTime(10) > 0
trigger1 = AnimElemTime(11) < 0
time = 1

[State 860]
type = Pause
triggerall = RoundState = 2
trigger1 = var(9)
trigger1 = AnimElemTime(11) = 0
time = 4

[State 860]
type = EnvShake
trigger1 = var(9)
trigger1 = AnimElemTime(9) = 1
time = 8
freq = 100
ampl = 4

[State 860]
type = BGPalFX
triggerall = var(9)
trigger1 = AnimElemTime(3) = 2
time = 60
sinadd = 90,30,-100,120 ;-100,-100,-100,180

[State 860]
type = afterimage
triggerall = var(9)
trigger1 = Time = 1
trans       = add1
FrameGap    = 3
time        = 12 ;20
PalBright   = 0,0,0
PalContrast = 255,255,255
PalAdd      = 0,0,0
PalMul      = 0.6,0.6,0.6
pausemovetime = 9999
supermovetime = 9999

[State 860]
type = ChangeAnim
triggerall = var(9)
trigger1 = AnimElemTime(9) = 0 
value = 1400
elem = 9

;---------------------[]
[state a];エフェクト1
type = Helper
trigger1 = animelemtime(2) = 0
id = 6060
name = "efe"
sprpriority = 2
pos = 0,0
postype = p1
stateno = 6060
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

[state a];エフェクト2
type = Helper
trigger1 = animelemtime(5) = 0
id = 6061
name = "efe2"
sprpriority = 2
pos = 0,0
postype = p1
stateno = 6061
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

;---------------------[ヘルパー]
[state a];
type = Helper
trigger1 = time = 0
trigger1 = var(9)
id = 2310
name = "sd"
sprpriority = 5
pos = 0,0
postype = p2
stateno = 2310
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state 860]
type = Helper
triggerall = var(9)
trigger1 = AnimElemTime(8) = 1
id = 2320
name = "sd"
sprpriority = 5
pos = (enemynear(var(2)),const(size.mid.pos.x)), (enemynear(var(2)),const(size.mid.pos.y)-15)
postype = p2
facing = 1
stateno = 2315
helpertype = normal
pausemovetime = 6
keyctrl = 0 
ownpal = 1

[state 860];出血
type = Helper
triggerall = var(9)
trigger1 = AnimElemTime(9) = 1
id = 7004
name = "blood"
sprpriority = 2
pos = 50,-2
postype = p1
stateno = 7004
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state 860];花びら
type = Helper
triggerall = var(9)
trigger1 = AnimElemTime(8) = 1
trigger2 = AnimElemTime(9) = 1
id = 6074
name = "tubaki"
sprpriority = 2
pos = (enemynear(var(2)),const(size.mid.pos.x)), (enemynear(var(2)),const(size.mid.pos.y))
postype = p2
stateno = 6074
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト
type = Helper
trigger1 = !var(9)
trigger1 = movehit = 1
trigger1 = animelem = 3,>=0 && animelem = 4,<0
trigger2 = var(9)
trigger2 = AnimElemTime(9) = 1
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 30) , floor(p2dist y/2 -50)-(random%30)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト
type = Helper
triggerall = !var(9)
trigger1 = movehit = 1
trigger1 = animelem = 5,>=0 && animelem = 6,<0
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 35) , floor(p2dist y/2 -35)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded = 1
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 7
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
triggerall = var(9) = 0
trigger1 = var(57) = 1
trigger1 = time = 0
v = 56
value = 15

;---------------------[立ちステートに戻る]
[state a];紫重閃
type = changestate
triggerall = var(56) < 249
trigger1 = animelem = 6,>=1
trigger1 = var(5) = 1
value = 1410

[state a];桜月華
type = changestate
triggerall = var(56) < 246
trigger1 = animelem = 6,>=1
trigger1 = var(5) = 2
value = 1420

[state a]
type = CtrlSet
trigger1 = AnimElemTime(11) = 0
value = 1

[state a]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)息吹攻撃エフェクト用ヘルパー1
[Statedef 6060]
type = A
ctrl = 0
anim = 6060
velset = 0,0
movetype = I
physics = N
sprpriority = 3

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state a]
type = bindtoparent
trigger1 = time = 0
pos = 0,0

[state a]
type = bindtoparent
trigger1 = animelem = 2
pos = 20,0

[state a]
type = velset
trigger1 = animelemtime(2) = 0
x = 2.0
y = -1.0

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = AfterImage
trigger1 = AnimElemTime(2) = 0
time = 14
length = 1
palcolor = 256
palinvertall = 0
palbright = 30,30,30
palcontrast = 120,120,220
palpostbright = 0,0,0
paladd = 10,10,25
palmul = .65,.65,.75
timegap = 1
framegap = 1
trans = "add1"

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0

;----------------------------------------------------------------------------
;(HELPER)息吹攻撃エフェクト用ヘルパー2
[Statedef 6061]
type = A
ctrl = 0
anim = 6061
velset = 0,0
movetype = I
physics = N
sprpriority = 3

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state a]
type = bindtoparent
trigger1 = time = 0
pos = 0,0

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = AfterImage
trigger1 = Time = 0
time = -1
length = 24
;palcolor = 256
;palinvertall = 0
palbright = 230,230,230
palcontrast = 255,255,255 ;220,220,220
;palpostbright = 0,0,0
paladd = 10,10,25
palmul = .65,.65,.75
timegap = 1
framegap = 1
trans = "add1"

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0


;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]

;---------------------------------------------------------------------------
; 紫重閃
[Statedef 1410]
type    = C
movetype= A
physics = N
velset = 0,0
anim = 1410
sprpriority = 1
ctrl = 0

[state a]
type = playerpush
trigger1 = 1
value = 0

;---------------------[効果音]
[state a];行きますよ
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1410,0
volume = 150

[state a];振り
type = playsnd
trigger1 = animelemtime(2) = 0
value = 300,2

[state a];振り
type = playsnd
trigger1 = animelemtime(6) = 0
value = 1410,1

[state a];鞘
type = playsnd
trigger1 = animtime = 0
value = 300,6

;---------------------[速度]
[state a]
type = VelSet
trigger1 = AnimElemTime(2) = 0
x = 30

[state a]
type = VelSet
trigger1 = AnimElemTime(4) = 0
trigger2 = AnimElemTime(9) = 0
x = 0

[state a]
type = VelSet
trigger1 = AnimElemTime(6) = 0
x = -30

[state a]
type = VelMul
trigger1 = AnimElemTime(6) = 0
x = 0.5

[state a]
type = VelMul
trigger1 = AnimElemTime(6) >= 0
trigger1 = AnimElemTime(7) < 4
x = 0.95

[state a]
type = VelSet
trigger1 = AnimElemTime(7) = 4
x = -2

[State -1]; 壁際粘り
type = VelAdd
triggerall = movehit
triggerall = AnimElemTime(4) > 2
triggerall = AnimElemTime(6) <= 0
trigger1 = p2statetype != A
trigger1 = enemynear(var(2)),backedgebodydist < 5
x = -0.5-2/(frontedgebodydist+1)*(frontedgebodydist+1)

;---------------------[]
[State explod];エフェクト
type = Explod
trigger1 = animelemtime(2) = 0
anim = 6002
id = 3000
sprpriority = 4
postype = p1
pos = -30,0
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

[State explod];エフェクト
type = Explod
trigger1 = animelemtime(6) = 0
anim = 6002
id = 3000
sprpriority = 4
postype = p1
pos = 30,0
facing = -1
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

;---------------------[]
[state a];エフェクト1
type = Helper
trigger1 = animelemtime(2) = 0
id = 6062
name = "efe"
sprpriority = 2
pos = 40,0
postype = p1
stateno = 6062
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

[state a];エフェクト2
type = Helper
trigger1 = animelemtime(6) = 0
id = 6063
name = "efe"
sprpriority = 2
pos = -20,0
postype = p1
stateno = 6063
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

;---------------------[攻撃]
[State 1410, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElemTime(2) = 0
attr = C,SA
damage    = 48,0
priority = 7, Hit
animtype  = hard
hitflag = MAFD
guardflag = LA
getpower = 14*(4+var(58)%4-(Random%5=0)),7*(4+var(58)%4-(Random%5=0))
givepower = 14*(6-var(58)%4-(Random%5=0)),7*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,13)
guard.pausetime = 7,19
sparkno = s-1
sparkxy = -20,-20
hitsound   = s400,1
guard.sparkno = s-1
guardsound = s120,1
ground.type = low
ground.slidetime = 12
guard.slidetime = 12
ground.hittime  = 12
yaccel = 0.38
ground.velocity = -9*fvar(4)
guard.velocity = -12
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -3,-2
air.fall = 1
fall.recover = 1
fall.recovertime = 41 ;32
fall.xvelocity = 0
fall.yvelocity = -3.4
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ID = 200
nochainID = 9999
envshake.time = 2
envshake.freq = 100
envshake.ampl = 1

[State 1410, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElemTime(6) = 0
attr = C,SA
damage    = 64,0
priority = 7, Hit
animtype  = hard
hitflag = MAFD
guardflag = LA
getpower = 14*(4+var(58)%4-(Random%5=0)),7*(4+var(58)%4-(Random%5=0))
givepower = 14*(6-var(58)%4-(Random%5=0)),7*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),13,11),ifelse((p2statetype=A)||(p2statetype=L),20,11)
guard.pausetime = 11,21
sparkno = s-1
sparkxy = -20,-50
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
ground.type = low
ground.slidetime = 10
guard.slidetime = 10
ground.hittime  = 10
yaccel = 0.38
ground.velocity = -0.25*fvar(4),-10
guard.velocity = 2
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = 3,2
fall = 1
fall.recover = ifelse(p2statetype=A,1,0)
fall.recovertime = 52 ;32
fall.xvelocity = 0
fall.yvelocity = -3.4
ground.cornerpush.veloff = -10
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ID = 200
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit = 1
trigger1 = animelem = 2,>=0 && animelem = 3,<0
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 50) , floor(p2dist y/2 -20)-(random%10)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ヒットエフェクト
type = Helper
trigger1 = movehit = 1
trigger1 = animelem = 6,>=0 && animelem = 8,<0
id = 7025
name = "hit"
pos = floor(p2dist x/2 + -10) , floor(p2dist y/2 -25)-(random%10)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded = 1
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 9999
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 9

;---------------------[立ちステートに戻る]
[state a]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)紫重閃攻撃エフェクト用ヘルパー1
[Statedef 6062]
type = A
ctrl = 0
anim = 6062
velset = 0,0
movetype = I
physics = N
sprpriority = 3

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state a]
type = null;bindtoparent
trigger1 = time = 0
pos = 0,0

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0

;----------------------------------------------------------------------------
;(HELPER)紫重閃攻撃エフェクト用ヘルパー2
[Statedef 6063]
type = A
ctrl = 0
anim = 6063
velset = 0,0
movetype = I
physics = N
sprpriority = 7

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[State 50, 4];残像
type = AfterImage
trigger1 = time = 0
time = 40
trans = addalpha
timegap = 1
framegap = 1
length = 12
palbright = 0,0,0
palcontrast = 128,90,90 ;256,180,180
palpostbright = 0,0,0
paladd = -20,-20,-20
palmul = 1,1,1

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0


;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;---------------------------------------------------------------------------
; 桜月華
[Statedef 1420]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 1420
sprpriority = 1
ctrl = 0

;---------------------[]
[State explod];エフェクト
type = Explod
trigger1 = animtime = 0
anim = 6002
id = 3000
sprpriority = 4
postype = p1
pos = -20,0
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

[State explod];エフェクト
type = Explod
trigger1 = animtime = 0
anim = 6002
id = 3000
sprpriority = 4
facing = -1
postype = p1
pos = 20,0
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 12

;---------------------[立ちステートに戻る]
[state a]
type = changestate
trigger1 = animtime = 0
value = 1421


;---------------------------------------------------------------------------
; 桜月華・攻撃
[Statedef 1421]
type    = A
movetype= A
physics = N
anim = 1421
sprpriority = 1
ctrl = 0

;---------------------[効果音]
[state a];はっ
type = playsnd
trigger1 = animelemtime(1) = 0
value = 1200,0
volume = 150

[state a];
type = playsnd
trigger1 = animelemtime(1) = 0
value = 1200,1

;---------------------[速度]
[state a]
type = Gravity
trigger1 = 1

[state a]
type = veladd
trigger1 = animelemtime(1) = 0
x = 3.5
y = -7.2

[state a]
type = velset
trigger1 = animelemtime(3) = 0
x = -3.5
y = -3.5

;---------------------[相手制御]
[state a]
type = targetstate
trigger1 = movehit = 1
value = 1229

;---------------------[攻撃]
[State 1421, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 2
attr = A, SA
damage    = 48,0
priority = 8, Hit
hitflag = MAFD
guardflag = MA
getpower = 6*(4+var(58)%4-(Random%5=0)),3*(4+var(58)%4-(Random%5=0))
givepower = 6*(6-var(58)%4-(Random%5=0)),3*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,7)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = hard
ground.type = high
ground.slidetime = 16
guard.slidetime = 16
ground.hittime  = 16
ground.velocity = -12*fvar(4),-4
guard.velocity = -10
air.velocity = -12*fvar(4),-4
airguard.velocity = -4,-2
fall = 1
fall.recover = 0
yaccel = 0.38
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = -12
airguard.cornerpush.veloff = -12
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 600
nochainID = 9999
envshake.time = 8
envshake.freq = 100
envshake.ampl = 4

;---------------------[ヘルパー]
[state a];ヒットエフェクト2
type = Helper
trigger1 = movehit
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 25) , floor(p2dist y/2 -65)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0
ownpal = 1

;---------------------[ヘルパー]
[state a];エフェクト2
type = Helper
trigger1 = animelemtime(2) = 0
id = 6051
name = "hit2"
sprpriority = 2
pos = 0,0
postype = p1
stateno = 6051
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

;---------------------[立ちステートに戻る]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= -25
value = 1210


;---------------------------------------------------------------------------
; 椿
[Statedef 1300]
type    = S
movetype= A
physics = S
vel = 0,0
anim = 1300
sprpriority = 1
ctrl = 0
hitcountpersist = 1

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[state a]
type = VarSet
triggerall = !var(59)
trigger1 = (command = "x") || (var(21) = 10)
trigger1 = Time = 0
trigger1 = prevstateno != 1300
trigger2 = AnimElemTime(8) = 0
trigger2 = prevstateno = 1300
v = 5
value = 0

[state a]
type = VarSet
triggerall = time = 0
trigger1 = !var(59)
trigger1 = (command = "y") || (var(21) = 11)
v = 5
value = 1

[state a]
type = VarSet
triggerall = time = 0
trigger1 = !var(59)
trigger1 = (command = "z") || (var(21) = 12)
v = 5
value = 2

[State AI, Middle]
type = VarSet
triggerall = var(59)
triggerall = time = 0
triggerall = p2stateno != 5703
triggerall = !numhelper(6070)
trigger1 = p2bodydist X < 90
trigger2 = ((p2bodydist X < 161) || (var(58)%4 = 0)) && ((p2bodydist X >= 161) || (var(58)%4 != 0))
v = 5
value = 1

[State AI, Hard]
type = VarSet
triggerall = var(59)
triggerall = time = 0
triggerall = p2bodydist X >= 90
triggerall = !numhelper(6070)
trigger1 = p2stateno = 5703
trigger2 = ((p2bodydist X >= 161) && (var(58)%4 != 0)) || ((p2bodydist X < 161) && (var(58)%4 = 0))
v = 5
value = 2

[State AI, Light]
type = VarSet
triggerall = var(59)
triggerall = time = 0
triggerall = p2stateno != 5703
trigger1 = numhelper(6070)
trigger2 = prevstateno = 1300
v = 5
value = 0

[state a]
type = ChangeAnim
triggerall = Time = 0
trigger1 = var(5) = 0
trigger2 = prevstateno = 1300
value = 1301

;---------------------[効果音]
[state a];ｼｯ！
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1400,0
volume = 150

[state a];振り
type = playsnd
trigger1 = animelemtime(5) = 0
value = 1300,0

[state a]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 300,4

;---------------------[]
[state a];
type = Helper
trigger1 = animelemtime(8) = 1
id = 6070+2*(var(5)=0)
name = "tubaki"
sprpriority = 2
pos = 100,0
postype = p1
stateno = 6070
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

;---------------------[攻撃]
[State 1300, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 8
attr = S, SA
damage    = 39,0
priority = 7, Hit
animtype  = hard
hitflag = MAFD
guardflag = MA
getpower = 26*(4+var(58)%4-(Random%5=0)),13*(4+var(58)%4-(Random%5=0))
givepower = 26*(6-var(58)%4-(Random%5=0)),13*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),9,7),ifelse((p2statetype=A)||(p2statetype=L),9,14)
guard.pausetime = 7,7
sparkno = s-1
sparkxy = -20,-10
hitsound   = s400,1
guard.sparkno = s-1
guardsound = s120,1
ground.type = low
ground.slidetime = 10
guard.slidetime = 10
ground.hittime  = 10
yaccel = 0.38
ground.velocity = -7*fvar(4)
guard.velocity = -7
air.velocity = -0.5*fvar(4),-6
airguard.velocity = -2,-1.23
air.fall = 1
fall.recover = 1
fall.recovertime = 34 ;25
fall.xvelocity = 0
fall.yvelocity = -3.4
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ID = 1300
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7003
name = "hit"
pos = -15, -floor(0.5*(p2dist Y))-75+35*(p2statetype=C)
postype = p2
stateno = 7003
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 12-5*(var(5)=0)

;---------------------[立ちステートに戻る]
[State 1300]
type = ChangeState
triggerall = !var(59)
triggerall = var(5) != 0
triggerall = var(56) < 251
trigger1 = movehit
trigger1 = (command = "L椿") || (var(21) = 10)
trigger2 = AnimElemTime(11) >= 0
trigger2 = (command = "L椿") || (var(21) = 10)
value = 1300

[state a]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; 枯れ椿
[Statedef 260]
type    = S
movetype= A
physics = S
vel = 0,0
anim = 1301
sprpriority = 1
ctrl = 0

[State 800]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = prevstateno = 800
value = 1301
elem = 3

;---------------------[効果音]
[state a];ｼｯ！
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1400,0
volume = 150

[State 2000, 6]
type = PlaySnd
trigger1 = AnimElemTime(5) = 0
value = 1300,0

[state a]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 300,4

;---------------------[]
[state a];
type = Helper
trigger1 = animelemtime(8) = 1
id = 6073
name = "tubaki"
sprpriority = 2
pos = 100,0
postype = p1
stateno = 6070
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state a];
type = Helper
trigger1 = animelemtime(8) = 1
id = 6074
name = "tubaki"
sprpriority = 2
pos = 100,-40
postype = p1
stateno = 6074
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

;---------------------[変数]
[state a];Pゲージ
type = VarAdd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 6

;---------------------[立ちステートに戻る]
[State 260]
type = ChangeState
triggerall = AnimElemTime(8) > 0
triggerall = InGuardDist
trigger1 = !var(59)
trigger1 = command = "holdback"
value = 120

[state a]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; 春風
[Statedef 1100]
type    = A
movetype= A
physics = N
juggle  = 0
poweradd= 0
anim = 1100
vel = 0,0
sprpriority = 1
ctrl = 0

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = animelem = 3,<=0
value = SCA
time = 1

;---------------------[効果音]
[state a];ふっ
type = playsnd
trigger1 = time = 0
value = 1100,0
volume = 150

[state a];
type = playsnd
trigger1 = time = 0
value = 300,4

;---------------------[速度]
[state a]
type = VelSet
trigger1 = time = 2
x = -5.7
y = -4.4

[state a]
type = VelAdd
trigger1 = time >= 2
y = 0.5

[State explod];スライディング
type = Explod
trigger1 = Time = 0
trigger2 = Time = 2
anim = 6002
id = 3000
sprpriority = 4
postype = p1
pos = 0,0
facing = -1
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 12

;---------------------[立ちステートに戻る]
[State 00]
type = ChangeState
triggerall = time > 1
triggerall = Vel Y > 0
trigger1 = Pos Y >= -9
value = 1101


;---------------------------------------------------------------------------
; 春風・スライディング
[Statedef 1101]
type    = S
movetype= A
physics = N
juggle  = 0
poweradd= 0
velset = 0,0
anim = 1101
sprpriority = 1
ctrl = 0
hitcountpersist = 1

[state a]
type = posset
trigger1 = time = 0
y = 0

;---------------------[効果音]
[state a];
type = playsnd
trigger1 = animelemtime(1) = 0
value = 40,0

[state a];
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1100,1

;---------------------[速度]
[state a]
type = velset
trigger1 = animelemtime(2) = 0
x = 16.5

[state a]
type = velmul
trigger1 = 1
x = 0.95

;---------------------[]
[State explod];着地エフェクト
type = Explod
trigger1 = animelemtime(1) = 0
anim = 6001
id = 3000
sprpriority = 4
postype = p1
pos = -30,0
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

[State explod];スライディング
type = Explod
trigger1 = animelemtime(2) > 0
trigger1 = AnimElemTime(2)%3 = 1
anim = 6002
id = 3000
sprpriority = 4
postype = p1
pos = -10,0
facing = 1
bindtime = 1
supermove = 0
ignorehitpause = 1
under = 0

;---------------------[攻撃]
[State 1101, 2]
type = HitDef
triggerall = var(50) > 0
trigger1 = animelem = 2
attr = C, SA
damage    = 36,0
priority = 7, Hit
animtype  = hard
hitflag = MAFD
guardflag = LA
getpower = 26*(4+var(58)%4-(Random%5=0)),13*(4+var(58)%4-(Random%5=0))
givepower = 26*(6-var(58)%4-(Random%5=0)),13*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A),11,9),ifelse((p2statetype=A),11,16)
guard.pausetime = 9,9
sparkno = s-1
sparkxy = -20,-10
hitsound   = s400,3
guard.sparkno = s-1
guardsound = s120,1
ground.type = low
ground.slidetime = 15
guard.slidetime = 15
ground.hittime  = 15
ground.velocity = -0.5*fvar(4),-4.5
guard.velocity = -4
air.velocity = -0.5*fvar(4),-4.5
airguard.velocity = -2,-1.23
yaccel = 0.38
fall = 1
fall.recover = ifelse((p2statetype=A)&&((!enemynear,hitfall)||(enemynear,GetHitVar(fall.recover))),1,0)
fall.recovertime = 36 ;25
fall.xvelocity = 0
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ID = 200
nochainID = 9999
envshake.time = 4
envshake.freq = 100
envshake.ampl = 2

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7000
name = "hit"
pos = floor(p2dist x/2 + 20) , floor(p2dist y/2 -0)-(random%10)
postype = p1
stateno = 7000
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0
ownpal = 1

;---------------------[立ちステートに戻る]
[state a];春風・舞
type = ChangeState
triggerall = !var(59)
triggerall = var(56) < 254
trigger1 = command = "x"
trigger1 = movecontact || ((animelemtime(1) >= 0) && (animelemtime(2) < 0))
value = 1110

[state a];中
type = ChangeState
triggerall = !var(59)
triggerall = var(56) < 254
trigger1 = movecontact || ((animelemtime(1) >= 0) && (animelemtime(2) < 0))
trigger1 = command = "y"
value = 410

[state a];強
type = ChangeState
triggerall = !var(59)
triggerall = var(56) < 254
trigger1 = movecontact || ((animelemtime(1) >= 0) && (animelemtime(2) < 0))
trigger1 = command = "z"
value = 420

[State AI, Mai]
type = ChangeState
triggerall = var(59)
triggerall = var(56) < 254
trigger1 = (animelemtime(1) >= 0) && (animelemtime(2) < 0)
trigger1 = ((var(58)%12 = 0) && !enemynear(var(2)),hitfall) || InGuardDist
trigger1 = p2stateno != [120,159]
trigger2 = moveguarded
trigger2 = var(58)%4 = 0
value = 1110

[State AI, Middle Geki]
type = ChangeState
triggerall = var(59)
triggerall = var(56) < 254
trigger1 = (animelemtime(1) >= 0) && (animelemtime(2) < 0)
trigger1 = (var(58)%6 = 1) || (p2bodydist X < 80)
trigger1 = !enemynear(var(2)),hitfall
trigger2 = movehit
trigger2 = var(58)%2 = 0
trigger3 = moveguarded
trigger3 = var(58)%4 = 1
value = 410

[State AI, Hard Geki]
type = ChangeState
triggerall = var(59)
triggerall = var(56) < 254
trigger1 = (animelemtime(1) >= 0) && (animelemtime(2) < 0)
trigger1 = (var(58)%6 = 2) || (p2bodydist X = [80,150])
trigger1 = !enemynear(var(2)),hitfall
trigger2 = movehit
trigger2 = var(58)%2 = 1
trigger3 = moveguarded
trigger3 = var(58)%4 = 2
value = 420

[state a]
type = ChangeState
trigger1 = time > 20
value = 1102

;---------------------------------------------------------------------------
; 春風・ジャンプ攻撃
[Statedef 1102]
type    = A
movetype= A
physics = N
juggle  = 0
poweradd= 0
anim = 1102
sprpriority = 1
ctrl = 0
hitcountpersist = 1

;---------------------[効果音]
[state a];
type = playsnd
trigger1 = animelemtime(2) = 0
value = 220,0+(Random%3)
volume = 150

[state a];
type = playsnd
trigger1 = animelemtime(2) = 0
value = 300,2

;---------------------[速度]
[state a]
type = Gravity
trigger1 = 1

[state a]
type = VelSet
trigger1 = time = 0
x = 4
y = -6.5

[state a]
type = VelSet
trigger1 = AnimElemTime(2) = 0
x = 2
y = -3

;---------------------[攻撃]
[State a]
type = TargetState
trigger1 = movehit = 1
value = 5701
ignorehitpause = 1

[State 1102, 3]
type = HitDef
triggerall = var(50) > 0
trigger1 = AnimElem = 2
attr = A, SA
damage    = 36,0
priority = 8, Hit
hitflag = MAFD
guardflag = HA
getpower = 52*(4+var(58)%4-(Random%5=0)),26*(4+var(58)%4-(Random%5=0))
givepower = 52*(6-var(58)%4-(Random%5=0)),26*(6-var(58)%4-(Random%5=0))
pausetime = ifelse((p2statetype=A)||(p2statetype=L),11,9),ifelse((p2statetype=A)||(p2statetype=L),11,9)
guard.pausetime = 9,9
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,2
guard.sparkno = s-1
guardsound = s120,1
animtype = back
ground.type = high
ground.slidetime = 16
guard.slidetime = 16
ground.hittime  = 16
ground.velocity = -12*fvar(4),24
guard.velocity = -10
air.velocity = -12*fvar(4),24
airguard.velocity = -5,-2
fall = 1
fall.recover = 0
fall.yvelocity = -3
fall.xvelocity = 0
yaccel = 0.38
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ID = 1102
nochainID = 9999
envshake.time = 12
envshake.freq = 100
envshake.ampl = 6

;---------------------[ヘルパー]
[state a];ヒットエフェクト2
type = Helper
trigger1 = movehit
id = 7025
name = "hit"
pos = floor(p2dist x/2 + 25) , floor(p2dist y/2 -25)-(random%20)
postype = p1
stateno = 7025
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0
ownpal = 1

;---------------------[ヘルパー]
[State explod];エフェクト
type = Explod
trigger1 = time = 0
anim = 6000
id = 3000
sprpriority = 2
postype = p1
pos = 0,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

[state a];エフェクト1
type = Helper
trigger1 = animelemtime(2) = 0
id = 6080
name = "hit2"
sprpriority = 2
pos = 40,-20
postype = p1
stateno = 6080
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

;---------------------[立ちステートに戻る]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= -15
value = 1210

;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)春風攻撃エフェクト用ヘルパー
[Statedef 6080]
type = A
ctrl = 0
anim = 6080
velset = 0,0
movetype = I
physics = N
sprpriority = 3

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = AfterImage
trigger1 = time = 0
trans = addalpha
length = 4
timegap = 1
frameGap = 1
time = 4
PalBright = 100,0,0
PalContrast = 50,50,50
PalAdd = 0,0,0
;PalMul = 0.8,0.8,0.8

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0

;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;---------------------------------------------------------------------------
; 春風・舞
[Statedef 1110]
type    = S
movetype= A
physics = N
juggle  = 0
poweradd= 0
velset = 0,0
anim = 1110
sprpriority = 1
ctrl = 0

[state a]
type = posset
trigger1 = time = 0
y = 0

[state a]
type = playerpush
trigger1 = 1
value = 0

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = animelem = 8,<=0
value = SCA
time = 1

;---------------------[効果音]
[state a];こっちです
type = playsnd
trigger1 = animelemtime(1) = 0
value = 520,0
volume = 150

[state a];
type = playsnd
trigger1 = animelemtime(1) = 0
value = 1000,1

;---------------------[ヘルパー]
[state a];
type = Helper
trigger1 = time = 0
id = 1111
name = "efe"
pos = 0,0
postype = p1
stateno = 1111
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[速度]
[state a]
type = velset
trigger1 = time = 0
x = 11

[state a]
type = velmul
trigger1 = 1
x = 0.93

;---------------------[変数]
[state a];Pゲージ
type = varadd
trigger1 = time = 0
trigger1 = var(57) = 1
v = 56
value = 4

;---------------------[立ちステートに戻る]
[state a]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)春風・舞分身用ヘルパー
[Statedef 1111]
type = A
ctrl = 0
anim = 1110
velset = 0,0
movetype = I
physics = N
sprpriority = -2

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 700, 2];無敵の状態を作る
type = NotHitBy
trigger1 = 1
value = SCA


[state a]
type = VarSet
trigger1 = time = 0
v = 1
value = 88

[state a]
type = varadd
trigger1 = 1
v = 1
value = 3

;---------------------[速度]
[state a]
type = velset
trigger1 = time = 0
x = 5

[state a]
type = velmul
trigger1 = 1
x = 0.93

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256-var(1),var(1)

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0



;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;特殊動作
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;---------------------------------------------------------------------------
; Bダッシュ・地上前方
[Statedef 500]
type    = S
physics = N
anim = 500
sprpriority = 1
poweradd = 0
ctrl = 0

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[state a]
type = PowerAdd
trigger1 = Time = 0
value = -1000

[state a]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[state a]
type = CtrlSet
trigger1 = !var(59)
trigger1 = animelemtime(2) = 0
value = 1

[State AI]
type = CtrlSet
triggerall = var(59)
triggerall = AnimElemTime(2) >= 0
trigger1 = p2movetype != I
trigger2 = p2statetype = A
trigger3 = p2bodydist X < 100
trigger4 = InGuardDist
value = 1

;---------------------[効果音]
[State 00];発動
type = PlaySnd
trigger1 = time = 0
value = 500, 0

[State 00];移動
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 500, 1

;---------------------[]
[State 01]
type = VelSet
trigger1 = animelemtime(2) = 0
x = 16

[State 02] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 03] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

;---------------------[]
[State 50, 4];残像
type = AfterImage
trigger1 = time = 0
time = -1
trans = add1
timegap = 1
framegap = 1
length = 9
palcolor = 256
palbright = 0,0,0
palcontrast = 100,100,200

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 6010
name = "efe1"
pos = -4,-32
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 8
keyctrl = 0 
ownpal = 1

[state a];移動
type = Helper
trigger1 = animelemtime(2) = 0
id = 6011
name = "efe1"
pos = 11,-32
postype = p1
stateno = 6011
helpertype = normal
pausemovetime = 8
keyctrl = 0 
ownpal = 1

;---------------------[]
[State 04]
type = ChangeState
triggerall = time > 11
trigger1 = time > 106
trigger2 = !var(59)
trigger2 = command != "holdfwd"
value = 501

[State AI]
type = ChangeState
triggerall = var(59)
triggerall = time > 11
trigger1 = vel X = 0
value = 501


; ダッシュ終了
[Statedef 501]
type    = S
physics = N
anim = 501
sprpriority = 1
ctrl = 1

[State 01]
type = Velmul
trigger1 = 1
x = 0.9

[State 01]
type = VelSet
trigger1 = AnimTime = 0
x = 0

[State 02] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 03] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 04]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Bダッシュ・地上上方
[Statedef 502]
type    = S
physics = N
ctrl = 0
anim = 502
poweradd = 0

[state a]
type = Turn
trigger1 = time = 0
trigger1 = p2dist X < 0

[state a]
type = PowerAdd
trigger1 = Time = 0
value = -1000

[state a]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[state a]
type = ctrlset
trigger1 = animelemtime(2) = 0
value = 1

;---------------------[]
[State 2000, 2]
type = Pause
trigger1 = time = 0
time = 15
movetime = 0
anim = -1

[State explod];ジャンプエフェクト
type = Explod
trigger1 = animelemtime(2) = 0
anim = 6000
id = 3000
sprpriority = 2
postype = p1
pos = 0,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

;---------------------[効果音]
[State 00];発動
type = PlaySnd
trigger1 = time = 0
value = 500, 0

;---------------------[]
[state a]
type = statetypeset
trigger1 = animelemtime(2) = 0
value = A

[state a]
type = velset
trigger1 = animelemtime(2) = 0
x = 4.5
y = -5.4

[State a]
type = Gravity
trigger1 = AnimElemTime(2) > 0

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 6010
name = "efe1"
pos = -4,-32
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

[State 50, 4];残像
type = AfterImage
trigger1 = AnimElemTime(2) = 0
time = -1
trans = add1
timegap = 1
framegap = 1
length = 9
palcolor = 256
palbright = 0,0,0
palcontrast = 100,100,200

;---------------------[]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= -10
value = 52

;---------------------------------------------------------------------------
; Bダッシュ・空中前方
[Statedef 503]
type    = A
physics = N
ctrl = 0
anim = 500
poweradd = 0

[state a]
type = PowerAdd
trigger1 = Time = 0
value = -1000

[state a]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[state a]
type = ctrlset
trigger1 = animelemtime(2) = 0
value = 1

;---------------------[]
[State 2000, 2]
type = Pause
trigger1 = time = 0
time = 11
movetime = 0
anim = -1

;---------------------[効果音]
[State 00];発動
type = PlaySnd
trigger1 = time = 0
value = 500, 0

[State 00];移動
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 500, 1

;---------------------[]
[state a]
type = velset
trigger1 = animelemtime(2) = 0
x = 21
y = -4

[state a]
type = veladd
trigger1 = animelem = 2,>=0
y = 0.3

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 6010
name = "efe1"
pos = -4,-32
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

[state a];移動
type = Helper
trigger1 = animelemtime(2) = 0
id = 6011
name = "efe1"
pos = 11,-32
postype = p1
stateno = 6011
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

[State 50, 4];残像
type = AfterImage
trigger1 = AnimElemTime(2) = 0
time = -1
trans = add1
timegap = 1
framegap = 1
length = 9
palcolor = 256
palbright = 0,0,0
palcontrast = 100,100,200

;---------------------[]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52

;---------------------------------------------------------------------------
; Bダッシュ・空中下方
[Statedef 505]
type    = A
physics = N
ctrl = 0
anim = 505
poweradd = 0

[state a]
type = PowerAdd
trigger1 = Time = 0
value = -1000

[state a]
type = ctrlset
trigger1 = animelemtime(2) = 0
value = 1

;---------------------[]
[State 2000, 2]
type = Pause
trigger1 = time = 0
time = 15
movetime = 0
anim = -1

;---------------------[効果音]
[State 00];発動
type = PlaySnd
trigger1 = time = 0
value = 500, 0

;---------------------[速度]
[state a]
type = velset
trigger1 = time = 0
y = 0

[state a]
type = Gravity
trigger1 = 1

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 6010
name = "efe1"
pos = -8,-62
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

[State 50, 4];残像
type = AfterImage
trigger1 = AnimElemTime(1) = 1
time = -1
trans = add1
timegap = 1
framegap = 1
length = 9
palcolor = 256
palbright = 0,0,0
palcontrast = 100,100,200

;---------------------[]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52

;---------------------------------------------------------------------------
; Bダッシュ・空中上方
[Statedef 506]
type    = A
physics = N
ctrl = 0
anim = 506
poweradd = 0

[state a]
type = PowerAdd
trigger1 = Time = 0
value = -1000

[state a]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[state a]
type = ctrlset
trigger1 = animelemtime(2) = 0
value = 1

;---------------------[]
[State 2000, 2]
type = Pause
trigger1 = time = 0
time = 15
movetime = 0
anim = -1

[State explod];エフェクト
type = Explod
trigger1 = animelemtime(2) = 0
anim = 6000
id = 3000
sprpriority = 2
postype = p1
pos = 0,0
bindtime = 1
supermove = 0
ignorehitpause = 0
under = 0
ownpal = 1

;---------------------[]
[State 00];発動
type = PlaySnd
trigger1 = time = 0
value = 500, 0

;---------------------[]
[state a]
type = velset
trigger1 = animelemtime(2) = 0
x = 3.5
y = -11

[state a]
type = Gravity
trigger1 = 1

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 6010
name = "efe1"
pos = -4,-32
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 30
keyctrl = 0 
ownpal = 1

[State 50, 4];残像
type = AfterImage
trigger1 = AnimElemTime(2) = 0
time = -1
trans = add1
timegap = 1
framegap = 1
length = 9
palcolor = 256
palbright = 0,0,0
palcontrast = 100,100,200

;---------------------[]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52


;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)Bダッシュ発動エフェクト用ヘルパー
[Statedef 6010]
type = A
ctrl = 0
anim = 6010
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = null;angledraw
trigger1 = 1
scale = 1.2,1.2

[State 50, 4];残像
type = AfterImage
trigger1 = time = 0
time = 40
trans = addalpha
timegap = 1
framegap = 1
length = 12
palbright = 0,0,0
palcontrast = 90,90,128 ;180,180,256
palpostbright = 0,0,0
paladd = -20,-20,-20
palmul = 1,1,1


;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0


;----------------------------------------------------------------------------
;(HELPER)Bダッシュ移動エフェクト用ヘルパー
[Statedef 6011]
type = A
ctrl = 0
anim = 6011
velset = -0.5,0
movetype = I
physics = N
sprpriority = 3

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = null;angledraw
trigger1 = 1
scale = 1.2,1.2

[State 50, 4];残像
type = AfterImage
trigger1 = time = 0
time = 40
trans = addalpha
timegap = 1
framegap = 1
length = 12
palbright = 0,0,0
palcontrast = 93,93,128 ;186,186,256
palpostbright = 0,0,0
paladd = -20,-20,-20
;palmul = 1,1,1


;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0

;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]

;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
;---------------------------------------------------------------------------
; Pチャージ
[Statedef 510]
type    = S
physics = N
anim = 510
velset = 0,0
sprpriority = 1
ctrl = 0

[State 511]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = prevstateno = 511
value = 510
elem = 9

;---------------------[]
[State 00];ふぅん
type = PlaySnd
trigger1 = time = 0
trigger1 = prevstateno != 511
trigger1 = Random%2 = 0
value = 510, 0
volume = 150

[State 00];発動
type = PlaySnd
trigger1 = time = 0
value = 510, 1

[State 00];発動
type = PlaySnd
trigger1 = AnimElemTime(9) = 0
trigger2 = AnimTime = 0
value = 510, 2

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 6020
name = "efe1"
pos = 0,0
postype = p1
stateno = 6020
helpertype = normal
pausemovetime = 8
keyctrl = 0 
ownpal = 1

[state a];発動2
type = Helper
trigger1 = time = 0
trigger2 = AnimElemTime(9) = 0
trigger3 = AnimTime = 0
id = 6021
name = "efe1"
pos = 0,10
postype = p1
stateno = 6021
helpertype = normal
pausemovetime = 8
keyctrl = 0 
ownpal = 1

;---------------------[ゲージ溜め]
[state a, Extend Charge];ライフ減少
type = LifeAdd
triggerall = !var(59)
triggerall = (time >= 32) || (prevstateno = 511)
triggerall = var(53) < 99
triggerall = life >= 10
triggerall = (!var(57) && (Power != PowerMax)) || var(57)
trigger1 = command = "F" || command = "D" || command = "U" || command = "B"
value = -10+5*(var(51)=-1)
kill = 0

[State AI, Extend Charge]
type = LifeAdd
triggerall = var(59)
triggerall = (time >= 32) || (prevstateno = 511)
triggerall = var(53) < 99
triggerall = life >= 10
triggerall = (!var(57) && (Power != PowerMax)) || var(57)
trigger1 = var(58)%10 = 0
trigger1 = life > 700
trigger2 = var(58)%5 = 0
trigger2 = life > 500
trigger2 = (p2life < 100) || (var(56) > 129)
value = -10+5*(var(51)=-1)
kill = 0

[state a, Extend Charge];ゲージチャージ速度増加
type = PowerAdd
triggerall = !var(59)
triggerall = var(57) = 0
triggerall = var(53) < 99
triggerall = time >= 32
triggerall = life >= 10
triggerall = Power != PowerMax
trigger1 = command = "F" || command = "D" || command = "U" || command = "B"
value = 10

[State AI, Extend Charge]
type = PowerAdd
triggerall = var(59)
triggerall = var(57) = 0
triggerall = var(53) < 99
triggerall = time >= 32
triggerall = life >= 10
triggerall = Power != PowerMax
trigger1 = var(58)%10 = 0
trigger1 = life > 700
trigger2 = var(58)%5 = 0
trigger2 = life > 500
trigger2 = (p2life < 100) || (var(56) > 129)
value = 10

[state a, Extend Charge];Pチャージ速度増加
type = VarAdd
triggerall = !var(59)
triggerall = var(57) = 1
triggerall = var(53) < 99
triggerall = (time >= 32) || (prevstateno = 511)
triggerall = life >= 10
trigger1 = command = "F" || command = "D" || command = "U" || command = "B"
v = 56
value = -1

[State AI, Extend Charge]
type = VarAdd
triggerall = var(59)
triggerall = var(57) = 1
triggerall = var(53) < 99
triggerall = (time >= 32) || (prevstateno = 511)
triggerall = life >= 10
trigger1 = var(58)%10 = 0
trigger1 = life > 700
trigger2 = var(58)%5 = 0
trigger2 = life > 500
trigger2 = (p2life < 100) || (var(56) > 129)
v = 56
value = -1

[state a, Extend Charge];攻撃力アップ
type = VarAdd
triggerall = !var(59)
triggerall = (time >= 32) || (prevstateno = 511)
triggerall = var(53) < 99
triggerall = var(51) != -1
triggerall = life >= 10
triggerall = (!var(57) && (Power != PowerMax)) || var(57)
trigger1 = command = "F" || command = "D" || command = "U" || command = "B"
v = 53
value = 1

[State AI, Extend Charge]
type = VarAdd
triggerall = var(59)
triggerall = (time >= 32) || (prevstateno = 511)
triggerall = var(53) < 99
triggerall = var(51) != -1
triggerall = life >= 10
triggerall = (!var(57) && (Power != PowerMax)) || var(57)
trigger1 = var(58)%10 = 0
trigger1 = life > 700
trigger2 = var(58)%5 = 0
trigger2 = life > 500
trigger2 = (p2life < 100) || (var(56) > 129)
v = 53
value = 1

[state a]
type = PowerAdd
triggerall = var(57) = 0
triggerall = Power != PowerMax
trigger1 = time >= 32
value = 10

[state a]
type = VarAdd
triggerall = var(57) = 1
triggerall = var(56) > -258*(LifeMax-Life)/LifeMax
trigger1 = time >= 32
trigger2 = prevstateno = 511
v = 56
value = -1

;---------------------[]
[State 04]
type = ChangeState
triggerall = !var(59)
triggerall = command != "おしっぱなしb"
trigger1 = time >= 32
trigger2 = prevstateno = 511
value = 0
ctrl = 1

[State AI]
type = ChangeState
triggerall = (time >= 32) || ((prevstateno = 511) && (time > 1))
triggerall = var(59)
trigger1 = var(57) = 1
trigger1 = var(56) <= -258*(LifeMax-Life)/LifeMax
trigger2 = var(57) = 0
trigger2 = Power = PowerMax
trigger3 = RoundState = 3
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; アドヴァンスドチャージ
[Statedef 511]
type    = S
physics = N
anim = 510
velset = 0,0
sprpriority = 1
poweradd = -1000
ctrl = 0

;---------------------[]
[State 00];ふんっ
type = PlaySnd
trigger1 = time = 0
value = 511, 0
volume = 150

[State 00];発動
type = PlaySnd
trigger1 = time = 0
value = 500, 1

;---------------------[ゲージ溜め]
[state a]
type = VarAdd
trigger1 = var(57) = 1
trigger1 = time = 0
v = 56
value = -63

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 6010
name = "efe1"
pos = 0,-46
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 8
keyctrl = 0 
ownpal = 1

;---------------------[]
[State 04]
type = ChangeState
trigger1 = time = 0
value = 510

;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)Pチャージエフェクト用ヘルパー1
[Statedef 6020]
type = A
ctrl = 0
anim = 6020
velset = 0,-0.5
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[透過]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = angledraw
trigger1 = 1
scale = 2.0,2.0

[State 50, 4];残像
type = null;AfterImage
trigger1 = time = 0
time = 40
trans = addalpha
timegap = 1
framegap = 1
length = 12
palbright = 0,0,0
palcontrast = 180,180,256
palpostbright = 0,0,0
paladd = -20,-20,-20
palmul = 1,1,1

;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0


;----------------------------------------------------------------------------
;(HELPER)Pチャージエフェクト用ヘルパー2
[Statedef 6021]
type = A
ctrl = 0
anim = 6021
movetype = I
physics = N
sprpriority = 5

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[速度]
[state a]
type = VelSet
trigger1 = time = 0
y = -4

[state a]
type = VelSet
trigger1 = time = 6
y = -10

;---------------------[透過]
[state a]
type = Trans
trigger1 = time < 6
trans = addalpha
alpha = 256,256

[state a]
type = Trans
trigger1 = time >= 6
trans = addalpha
alpha = 256-24*(time-6),256

[state a]
type = AngleDraw
trigger1 = time < 6
scale = 0.4+0.15*time,0.4+0.15*time

[state a]
type = AngleDraw
trigger1 = time = [6,9]
scale = 1.2,1.2

[state a]
type = AngleDraw
trigger1 = time > 9
scale = 1.2-0.05*(time-9),1.2-0.05*(time-9)

[State 50, 4];残像
type = AfterImage
trigger1 = time = 0
time = -1
trans = addalpha
timegap = 1
framegap = 1
length = 8
palbright = 0,0,0
palcontrast = 35,50,75
palpostbright = 0,0,0
paladd = 0,0,0
palmul = .95,.95,.95

;---------------------[]
[state a]
type = DestroySelf
trigger1 = AnimTime = 0

;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;---------------------------------------------------------------------------
; 超回復
[Statedef 520]
type    = S
physics = N
anim = 520
velset = 0,0
sprpriority = 1
ctrl = 0

;---------------------[]
[State 00];いきます
type = PlaySnd
trigger1 = time = 0
value = 2300, 0
volume = 150

[State 00];発動
type = PlaySnd
trigger1 = animelemtime(5) = 0
value = 530, 0

;---------------------[変数]
[state a]
type = varadd
trigger1 = time = 0
v = 55
value = 1

;---------------------[ゲージ溜め]
[state a]
type = varadd
trigger1 = var(57) = 1
trigger1 = AnimElemTime(5) > 0 ;Time > 28
v = 56
value = -1 ;-2

[state a]
type = poweradd
trigger1 = var(57) = 0
trigger1 = AnimElemTime(5) > 0
value = 10

[state a]
type = lifeadd
trigger1 = AnimElemTime(5) > 0
value = 4 ;5

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = time = 0
id = 525
name = "efe1"
pos = 0,0
postype = p1
stateno = 525
helpertype = normal
pausemovetime = 8
keyctrl = 0 
ownpal = 1

[state a];青蛍
type = Helper
trigger1 = AnimElemTime(5) = 0
trigger2 = AnimElemTime(6) = 0
trigger3 = AnimElemTime(7) = 0
trigger4 = AnimElemTime(8) = 0
id = 527
name = "hotaru"
pos = 40-Random%80,-Random%25
postype = p1
stateno = 527
helpertype = normal
pausemovetime = 9999
keyctrl = 0 
ownpal = 1

[state a];青蛍2
type = Helper
trigger1 = AnimElemTime(6) = 0
trigger2 = AnimElemTime(8) = 0
id = 527
name = "hotaru"
pos = 40-Random%80,-Random%25
postype = p1
stateno = 527
helpertype = normal
pausemovetime = 9999
keyctrl = 0 
ownpal = 1

[state a];湯煙
type = Helper
trigger1 = AnimElemTime(5) = 0
trigger2 = AnimElemTime(7) = 0
id = 528
name = "mist"
pos = 0,-Random%25
postype = p1
stateno = 528
helpertype = normal
pausemovetime = 9999
keyctrl = 0 
ownpal = 1

;---------------------[]
[State 04]
type = ChangeState
trigger1 = Time > 69 ;46
value = 521

;---------------------------------------------------------------------------
; 超回復・終了
[Statedef 521]
type    = S
physics = N
anim = 521
velset = 0,0
sprpriority = 1
ctrl = 0

;---------------------[ゲージ溜め]
[state a]
type = varadd
trigger1 = var(57) = 1
trigger1 = AnimElemTime(5) < 0
v = 56
value = -1 ;-2

[state a]
type = poweradd
trigger1 = var(57) = 0
trigger1 = AnimElemTime(5) < 0
value = 10

[state a]
type = LifeAdd
trigger1 = AnimElemTime(4) < 3
value = ifelse(Time<5,3,ifelse(Time<8,2,1)) ;5

;---------------------[]
[State 04]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1


;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)超回復エフェクト用ヘルパー
[Statedef 525]
type = A
ctrl = 0
anim = 520
velset = 0,0
movetype = I
physics = N
sprpriority = 4

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state a]
type = nothitby
trigger1 = 1
value = SCA
time = 1

;---------------------[透過]
[state a]
type = Trans
trigger1 = AnimElemTime(5) < 0
trans = addalpha
alpha = 256,0

[state a]
type = Trans
triggerall = root,stateno = 2401
trigger1 = AnimElemTime(5) < 0
trans = addalpha
alpha = 256,256

[state a]
type = Trans
trigger1 = AnimElemTime(5) >= 0
trans = addalpha
alpha = 256-20*(Time-12),256

[state a]
type = AngleDraw
trigger1 = AnimElemTime(5) >= 0
scale = 1.0+0.0075*(Time-12),1.0+0.0075*(Time-12)

[state a]
type = AngleDraw
triggerall = root,stateno = 2401
trigger1 = AnimElemTime(5) >= 0
scale = 1.0+0.015*(Time-12),1.0+0.015*(Time-12)

[state a]
type = PalFX
trigger1 = AnimElemTime(5) = 0
time = -1
add = 50,50,50

;---------------------[]
[state a]
type = DestroySelf
trigger1 = time = 24

;----------------------------------------------------------------------------
; 超回復青蛍
[Statedef 527]
type = A
ctrl = 0
anim = 6005
movetype = I
physics = N
sprpriority = 3

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[速度]
[state a]
type = VelSet
trigger1 = time = 0
x = -1.09+(Random%20)/10
y = -2.09+(Random%20)/10

;---------------------[透過、拡縮]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[state a]
type = AngleDraw
trigger1 =  Time <= 10
scale = 0.1,0.1

[state a]
type = AngleDraw
trigger1 = Time > 10
scale = 0.1-0.005*(Time-10),0.1-0.005*(Time-10)

[state a]
type = PalFX
trigger1 = time = 0
time = -1
add = 0,0,100
mul = 256,256,256

[state a]
type = AfterImage
trigger1 = time = 0
trans = addalpha
length = 5
timegap = 1
frameGap = 4 ;1
time = -1 ;7
PalBright = 0,0,100
PalContrast = 150,150,200 ;100,100,155
PalAdd = 0,0,0
PalMul = 1,1,1 ;0.8,0.8,0.8

;---------------------[]
[state a]
type = DestroySelf
trigger1 = time = 30

;----------------------------------------------------------------------------
; 超回復湯煙
[Statedef 528]
type = A
ctrl = 0
anim = 6005
movetype = I
physics = N
sprpriority = 3

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;---------------------[速度]
[state a]
type = VelSet
triggerall = time = 0
trigger1 = ishelper(528)
x = -1+(Random%20)/10
y = -3+(20-Random%20)/10

[state a]
type = VelSet
triggerall = time = 0
trigger1 = ishelper(529)
x = -1.5+(Random%20)/20
y = -3+(20-Random%20)/10

[state a]
type = VelSet
triggerall = time = 0
trigger1 = ishelper(530)
x = 1.5-(Random%20)/20
y = -3+(20-Random%20)/10

;---------------------[透過、拡縮]
[state a]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 64,256

[state a]
type = AngleDraw
trigger1 =  Time <= 10
scale = 1.2,1.2

[state a]
type = AngleDraw
trigger1 = Time > 10
scale = 1.2-0.06*(Time-10),1.2-0.06*(Time-10)

[state a]
type = PalFX
trigger1 = time = 0
time = -1
mul = 256,230,230

[state a]
type = AfterImage
trigger1 = time = 0
time = -1
length = 4
palcontrast = 60,40,40
timegap = 1
framegap = 2
trans = addalpha

[state a];湯煙左
type = Helper
triggerall = ishelper(528)
trigger1 = time = 0
id = 529
name = "mist"
pos = -20,0
postype = p1
stateno = 528
helpertype = normal
pausemovetime = 9999
keyctrl = 0 
ownpal = 1

[state a];湯煙右
type = Helper
triggerall = ishelper(528)
trigger1 = time = 0
id = 530
name = "mist"
pos = 20,0
postype = p1
stateno = 528
helpertype = normal
pausemovetime = 9999
keyctrl = 0 
ownpal = 1

;---------------------[]
[state a]
type = destroyself
trigger1 = time = 30


;----------------------------------------------------------------------------
;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;---------------------------------------------------------------------------
; Bカウンター
[Statedef 530]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 530
poweradd = -1000

[state a]
type = posset
trigger1 = time = 0
y = 0

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = animelem = 7,<=0
value = SCA
time = 1

;---------------------[効果音]
[State 200, 1];そうはいきません
type = PlaySnd
trigger1 = animelemtime(1) = 0
value = 530, 1
volume = 150

[State 200, 1];
type = PlaySnd
trigger1 = animelemtime(1) = 0
value = 500, 0

;---------------------[]
[State 2000, 2]
type = Pause
trigger1 = AnimElemTime(1) = 1
time = 21
movetime = 0
anim = -1

;---------------------[]
[state a]
type = velset
trigger1 = animelemtime(4) = 0
x = 4

;---------------------[ヘルパー]
[state a];発動
type = Helper
trigger1 = animelemtime(1) = 1
id = 6010
name = "efe1"
pos = -4,-52
postype = p1
stateno = 6010
helpertype = normal
pausemovetime = 16
keyctrl = 0 
ownpal = 1

;---------------------[]
[State 210, 2]
type = HitDef
trigger1 = animelem = 4
attr = S, NA
animtype  = up
damage    = 0
priority = 10, Hit
getpower = 0,0
givepower = 0,0
guardflag = MA
pausetime = ifelse((p2statetype=A),11,9),ifelse((p2statetype=A),11,9)
guard.pausetime = 9,9
sparkno = s-1
sparkxy = 0,0
hitsound   = s400,4
guardsound = s120,0
guard.sparkno = s-1
ground.type = low
ground.slidetime = 17
ground.hittime  = 17
yaccel = 0.38
ground.velocity = 0,-10
guard.velocity = -5
air.velocity = 0,-9
airguard.velocity = -3,-1
fall = 1
fall.recover = 1
fall.recovertime = ifelse((p2statetype=A),59,57) ;53,51  42
fall.xvelocity = 0
fall.yvelocity = -3.4
p2facing = ifelse(facing*(enemynear,facing)*(p2dist X)>0,facing*(enemynear,facing),0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ID = 530
nochainID = 9999

;---------------------[ヘルパー]
[state a];ヒットエフェクト
type = Helper
trigger1 = movehit
id = 7000
name = "hit"
pos = floor(p2dist x/2 +30) , floor(p2dist y/2 -55)
postype = p1
stateno = 7000
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

[state a];ガードエフェクト
type = Helper
trigger1 = moveguarded
id = 7010
name = "hit"
pos = 0,-70+30*(p2statetype=C)
postype = p2
facing = -1
stateno = 7010
helpertype = normal
pausemovetime = 0
persistent = 0
ignorehitpause = 1
keyctrl = 0
ownpal = 1

;---------------------[]
[State 530]
type = CtrlSet
trigger1 = AnimElemTime(12) = 0
value = 1

[State 530, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Bエスケープ
[Statedef 535]
type    = A
physics = N
ctrl = 0
anim = 122
velset = 0,0

;---------------------[ゲージ消費]; Pゲージの有無で変動
[State 2000, 1]
type = PowerAdd
trigger1 = Time = 0
trigger1 = prevstateno != [800,801]
trigger1 = prevstateno != 20
value = ifelse(var(57) = 1, -2000, -3000)

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = 1
value = SCA
time = 1

[state a]
type = playerpush
trigger1 = 1
value = 0

;---------------------[]
[State 00];こっちです
type = PlaySnd
trigger1 = time = 0
value = 520,0
volume = 150
channel = 7

[State 00];dush
type = PlaySnd
trigger1 = time = 0
value = 110,0

[State 00];escape
type = PlaySnd
trigger1 = time = 0
value = 520,2

[State 00];かしんっ
type = PlaySnd
trigger1 = time = 0
value = 1410,1

;---------------------[]
[state a]
type = PosSet
trigger1 = Time = 0
trigger1 = prevstateno = 801
x = -10
y = 0

[state a, fwd]
type = VelSet
triggerall = time = 0
triggerall = prevstateno != [800,801]
triggerall = prevstateno != 20
trigger1 = !var(59)
trigger1 = command = "holdfwd"
x = 7
y = -3

[state a, back]
type = VelSet
triggerall = time = 0
trigger1 = !var(59)
trigger1 = command = "holdback"
trigger2 = prevstateno = [800,801]
trigger3 = prevstateno = 20
x = -7
y = -3

[State AI, fwd]
type = VelSet
triggerall = var(59)
triggerall = time = 0
triggerall = prevstateno != [800,801]
triggerall = prevstateno != 20
trigger1 = p2dist X >= 0
trigger1 = p2bodydist X < 60
trigger1 = enemynear(var(2)),backedgebodydist > 30
trigger2 = p2bodydist X <= -60
trigger3 = p2dist X < 0
trigger3 = enemynear(var(2)),backedgebodydist <= 30
x = 7
y = -3

[State AI, back]
type = VelSet
triggerall = var(59)
triggerall = time = 0
triggerall = prevstateno != [800,801]
triggerall = prevstateno != 20
trigger1 = p2dist X < 0
trigger1 = p2bodydist X > -60
trigger1 = enemynear(var(2)),backedgebodydist > 30
trigger2 = p2bodydist X >= 60
trigger3 = p2dist X >= 0
trigger3 = enemynear(var(2)),backedgebodydist <= 30
x = -7
y = -3

[state a]
type = Gravity
trigger1 = 1

;---------------------[ヘルパー]
[state a, Air Dush Effect];空中ダッシュエフェクト
type = Helper
trigger1 = time = 0
id = 6000
name = "a_dash"
sprpriority = -2
pos = 0,-65
postype = p1
stateno = 6003
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state a];発動
type = Helper
trigger1 = time = 0
id = 6030
name = "efe1"
pos = -4,-62
postype = p1
stateno = 6030
helpertype = normal
pausemovetime = 0 ;30
keyctrl = 0 
ownpal = 1

[state a, Air Dush Effect];空中ダッシュエフェクト
type = Helper
triggerall = time = 0
trigger1 = prevstateno = [800,801]
trigger2 = prevstateno = 20
id = 6000
name = "a_dash"
sprpriority = -2
pos = 0,-65
postype = p2
stateno = 6003
helpertype = normal
pausemovetime = 0
keyctrl = 0 
ownpal = 1

[state a];発動
type = Helper
triggerall = time = 0
trigger1 = prevstateno = [800,801]
trigger2 = prevstateno = 20
id = 6030
name = "efe1"
pos = -4,-62
postype = p2
stateno = 6030
helpertype = normal
pausemovetime = 0 ;30
keyctrl = 0 
ownpal = 1

;---------------------[]
[State 00]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52

;---------------------------------------------------------------------------
; 投げ抜け（相手）
[Statedef 536]
type    = A
physics = N
ctrl = 0
anim = 122
velset = 0,0

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = 1
value = SCA
time = 1

[state a]
type = playerpush
trigger1 = 1
value = 0

[state a]
type = PosSet
trigger1 = Time = 0
trigger1 = prevstateno = 810
x = -10
y = 0

[state a]
type = velset
trigger1 = time = 0
x = -7
y = -3

[state a]
type = VelAdd
trigger1 = 1
y = 0.38

;---------------------[]
[State 00]
type = SelfState
triggerall = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52

;[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]
;----------------------------------------------------------------------------
;(HELPER)Bエスケープエフェクト用ヘルパー
[Statedef 6030]
type = A
ctrl = 0
anim = 6030
velset = 0,0
movetype = I
physics = N
sprpriority = 7

[state a]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state a]
type = ChangeAnim
triggerall = ishelper(6031)
trigger1 = time = 0
value = 6031

;---------------------[無敵]
[state a]
type = nothitby
trigger1 = 1
value = SCA
time = 1

;---------------------[透過]
[state a]
type = Trans
trigger1 = AnimElemTime(4) < 0
trans = addalpha
alpha = 192,256

[state a]
type = Trans
triggerall = ishelper(6030)
trigger1 = AnimElemTime(4) >= 0
trigger1 = AnimElemTime(4) <= 4
trans = addalpha
alpha = 192-48*(Time-7),256

[state a]
type = Trans
triggerall = ishelper(6031)
trigger1 = AnimElemTime(4) >= 0
trigger1 = AnimElemTime(4) <= 4
trans = addalpha
alpha = 192-48*(Time-12),256

[state a]
type = Trans
trigger1 = AnimElemTime(4) > 4
trans = addalpha
alpha = 0,256

[state a]
type = AngleDraw
triggerall = ishelper(6030)
trigger1 = AnimElemTime(2) < 0
scale = 1+0.5*Time,1+0.5*Time

[state a]
type = AngleDraw
trigger1 = ishelper(6031)
trigger1 = AnimElemTime(1) < 4
scale = 2+0.1*Time,2+0.1*Time

[state a]
type = AngleDraw
triggerall = ishelper(6030)
trigger1 = AnimElemTime(2) >= 0
trigger1 = AnimElemTime(3) < 4
scale = 2+0.1*(Time-2),2+0.1*(Time-2)

[state a]
type = AngleDraw
triggerall = ishelper(6031)
trigger1 = AnimElemTime(1) >= 4
trigger1 = AnimElemTime(3) < 4
scale = 2+0.1*(Time-3),2+0.1*(Time-3)

[state a]
type = AngleDraw
trigger1 = AnimElemTime(3) >= 4
scale = 2.6,2.6

[state a]
type = PalFx
triggerall = ishelper(6031)
trigger1 = time = 0
time = -1
add = 0,0,64
mul = 10,10,100

[state a];発動
type = Helper
triggerall = ishelper(6030)
trigger1 = AnimElemTime(2) = -1
id = 6031
name = "efe1"
pos = 0,0
postype = p1
stateno = 6030
helpertype = normal
pausemovetime = 0 ;30
keyctrl = 0
ownpal = 1

;---------------------[]
[state a]
type = DestroySelf
trigger1 = AnimTime = 0



;---------------------------------------------------------------------------
; Varのラウンド持ち越し
[Statedef 5900]
type = S

[state a]
type = VarSet
trigger1 = time = 0
v = 19
value = 0

[State 5900, 1] ;Clear all int variables
type = VarRangeSet
trigger1 = roundsexisted = 0
first = 2
last = 59
value = 0

[State 5900, 2] ;Clear all float variables
type = null;VarRangeSet
trigger1 = roundsexisted = 0
fvalue = 0

[State 5900, 3] ;Intro for round 1
type = ChangeState
trigger1 = roundno = 1
value = 190

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

